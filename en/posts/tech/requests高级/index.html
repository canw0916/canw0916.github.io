<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Requestsé«˜çº§ | Felix's Blog</title><meta name=keywords content><meta name=description content="

ç®€å†æ¨¡æ¿ä¸‹è½½æ‹“å±•


  import requests
  from lxml import etree
  import os
  headers = {
      'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36',

  }
  #åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹
  dirName = 'jianli'
  if not os.path.exists(dirName):
      os.mkdir(dirName)

  #é€šç”¨çš„urlæ¨¡æ¿
  url = 'https://sc.chinaz.com/jianli/free_%d.html'
  for page in range(1,11):
      if page == 1:
          new_url = 'https://sc.chinaz.com/jianli/free.html'
      else:
          new_url = format(url%page)
      response = requests.get(url=new_url,headers=headers)
      response.encoding = 'utf-8'
      page_text = response.text
      #æ•°æ®è§£æï¼šè¯¦æƒ…é¡µurlå’Œç®€å†åç§°
      tree = etree.HTML(page_text)
      div_list = tree.xpath('//*[@id=&#34;container&#34;]/div')
      #å±€éƒ¨è§£æ
      for div in div_list:
          detail_url = 'https:'+div.xpath('./a/@href')[0]
          title = div.xpath('./p/a/text()')[0]+'.rar'
          # print(title,detail_url)
          #å¯¹è¯¦æƒ…é¡µçš„urlå‘èµ·è¯·æ±‚ï¼Œè§£æå‡ºç®€å†çš„ä¸‹è½½åœ°å€
          detail_page_text = requests.get(url=detail_url,headers=headers).text
          #æ•°æ®è§£æï¼šè§£æä¸‹è½½åœ°å€
          detail_tree = etree.HTML(detail_page_text)
          li_list = detail_tree.xpath('//*[@id=&#34;down&#34;]/div[2]/ul/li')
          down_list = [] #å­˜å‚¨ä¸åŒçš„12ä¸ªä¸‹è½½åœ°å€
          for li in li_list:
              download_link = li.xpath('./a/@href')[0]
              down_list.append(download_link)
          #éšæœºé€‰æ‹©ä¸€ä¸ªä¸‹è½½åœ°å€è¿›è¡Œç®€å†æ¨¡æ¿çš„ä¸‹è½½
          import random
          #ä»åˆ—è¡¨ä¸­éšæœºé€‰å‡ºä¸€ä¸ªä¸‹è½½åœ°å€
          link = random.choice(down_list)
          #å¯¹ä¸‹è½½åœ°å€è¿›è¡Œè¯·æ±‚å‘é€ï¼Œä¸‹è½½ç®€å†æ¨¡æ¿çš„å‹ç¼©åŒ…
          data = requests.get(url=link,headers=headers).content
          filePath = dirName+'/'+title
          with open(filePath,'wb') as fp:
              fp.write(data)
          print(title,'ä¸‹è½½ä¿å­˜æˆåŠŸï¼')


Cookie


ä»€ä¹ˆæ˜¯cookieï¼Ÿ"><meta name=author content="
ä½œè€…:Felix"><link rel=canonical href=https://canw0916.github.io/en/posts/tech/requests%E9%AB%98%E7%BA%A7/><link crossorigin=anonymous href=/assets/css/stylesheet.67971badef1fb278a7dbb01fdd6e1add4dae2ea34bb3a44665b66327fad3f0ab.css integrity="sha256-Z5cbre8fsnin27Af3W4a3U2uLqNLs6RGZbZjJ/rT8Ks=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://canw0916.github.io/img/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://canw0916.github.io/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://canw0916.github.io/img/favicon-32x32.png><link rel=apple-touch-icon href=https://canw0916.github.io/img/apple-touch-icon.png><link rel=mask-icon href=https://canw0916.github.io/img/android-chrome-512x512.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://canw0916.github.io/en/posts/tech/requests%E9%AB%98%E7%BA%A7/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-7ENSZ7BS0C"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-7ENSZ7BS0C")}</script><meta property="og:title" content="Requestsé«˜çº§"><meta property="og:description" content="

ç®€å†æ¨¡æ¿ä¸‹è½½æ‹“å±•


  import requests
  from lxml import etree
  import os
  headers = {
      'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36',

  }
  #åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹
  dirName = 'jianli'
  if not os.path.exists(dirName):
      os.mkdir(dirName)

  #é€šç”¨çš„urlæ¨¡æ¿
  url = 'https://sc.chinaz.com/jianli/free_%d.html'
  for page in range(1,11):
      if page == 1:
          new_url = 'https://sc.chinaz.com/jianli/free.html'
      else:
          new_url = format(url%page)
      response = requests.get(url=new_url,headers=headers)
      response.encoding = 'utf-8'
      page_text = response.text
      #æ•°æ®è§£æï¼šè¯¦æƒ…é¡µurlå’Œç®€å†åç§°
      tree = etree.HTML(page_text)
      div_list = tree.xpath('//*[@id=&#34;container&#34;]/div')
      #å±€éƒ¨è§£æ
      for div in div_list:
          detail_url = 'https:'+div.xpath('./a/@href')[0]
          title = div.xpath('./p/a/text()')[0]+'.rar'
          # print(title,detail_url)
          #å¯¹è¯¦æƒ…é¡µçš„urlå‘èµ·è¯·æ±‚ï¼Œè§£æå‡ºç®€å†çš„ä¸‹è½½åœ°å€
          detail_page_text = requests.get(url=detail_url,headers=headers).text
          #æ•°æ®è§£æï¼šè§£æä¸‹è½½åœ°å€
          detail_tree = etree.HTML(detail_page_text)
          li_list = detail_tree.xpath('//*[@id=&#34;down&#34;]/div[2]/ul/li')
          down_list = [] #å­˜å‚¨ä¸åŒçš„12ä¸ªä¸‹è½½åœ°å€
          for li in li_list:
              download_link = li.xpath('./a/@href')[0]
              down_list.append(download_link)
          #éšæœºé€‰æ‹©ä¸€ä¸ªä¸‹è½½åœ°å€è¿›è¡Œç®€å†æ¨¡æ¿çš„ä¸‹è½½
          import random
          #ä»åˆ—è¡¨ä¸­éšæœºé€‰å‡ºä¸€ä¸ªä¸‹è½½åœ°å€
          link = random.choice(down_list)
          #å¯¹ä¸‹è½½åœ°å€è¿›è¡Œè¯·æ±‚å‘é€ï¼Œä¸‹è½½ç®€å†æ¨¡æ¿çš„å‹ç¼©åŒ…
          data = requests.get(url=link,headers=headers).content
          filePath = dirName+'/'+title
          with open(filePath,'wb') as fp:
              fp.write(data)
          print(title,'ä¸‹è½½ä¿å­˜æˆåŠŸï¼')


Cookie


ä»€ä¹ˆæ˜¯cookieï¼Ÿ"><meta property="og:type" content="article"><meta property="og:url" content="https://canw0916.github.io/en/posts/tech/requests%E9%AB%98%E7%BA%A7/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-10T14:04:30+08:00"><meta property="article:modified_time" content="2023-02-10T14:04:30+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Requestsé«˜çº§"><meta name=twitter:description content="

ç®€å†æ¨¡æ¿ä¸‹è½½æ‹“å±•


  import requests
  from lxml import etree
  import os
  headers = {
      'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36',

  }
  #åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹
  dirName = 'jianli'
  if not os.path.exists(dirName):
      os.mkdir(dirName)

  #é€šç”¨çš„urlæ¨¡æ¿
  url = 'https://sc.chinaz.com/jianli/free_%d.html'
  for page in range(1,11):
      if page == 1:
          new_url = 'https://sc.chinaz.com/jianli/free.html'
      else:
          new_url = format(url%page)
      response = requests.get(url=new_url,headers=headers)
      response.encoding = 'utf-8'
      page_text = response.text
      #æ•°æ®è§£æï¼šè¯¦æƒ…é¡µurlå’Œç®€å†åç§°
      tree = etree.HTML(page_text)
      div_list = tree.xpath('//*[@id=&#34;container&#34;]/div')
      #å±€éƒ¨è§£æ
      for div in div_list:
          detail_url = 'https:'+div.xpath('./a/@href')[0]
          title = div.xpath('./p/a/text()')[0]+'.rar'
          # print(title,detail_url)
          #å¯¹è¯¦æƒ…é¡µçš„urlå‘èµ·è¯·æ±‚ï¼Œè§£æå‡ºç®€å†çš„ä¸‹è½½åœ°å€
          detail_page_text = requests.get(url=detail_url,headers=headers).text
          #æ•°æ®è§£æï¼šè§£æä¸‹è½½åœ°å€
          detail_tree = etree.HTML(detail_page_text)
          li_list = detail_tree.xpath('//*[@id=&#34;down&#34;]/div[2]/ul/li')
          down_list = [] #å­˜å‚¨ä¸åŒçš„12ä¸ªä¸‹è½½åœ°å€
          for li in li_list:
              download_link = li.xpath('./a/@href')[0]
              down_list.append(download_link)
          #éšæœºé€‰æ‹©ä¸€ä¸ªä¸‹è½½åœ°å€è¿›è¡Œç®€å†æ¨¡æ¿çš„ä¸‹è½½
          import random
          #ä»åˆ—è¡¨ä¸­éšæœºé€‰å‡ºä¸€ä¸ªä¸‹è½½åœ°å€
          link = random.choice(down_list)
          #å¯¹ä¸‹è½½åœ°å€è¿›è¡Œè¯·æ±‚å‘é€ï¼Œä¸‹è½½ç®€å†æ¨¡æ¿çš„å‹ç¼©åŒ…
          data = requests.get(url=link,headers=headers).content
          filePath = dirName+'/'+title
          with open(filePath,'wb') as fp:
              fp.write(data)
          print(title,'ä¸‹è½½ä¿å­˜æˆåŠŸï¼')


Cookie


ä»€ä¹ˆæ˜¯cookieï¼Ÿ"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ğŸ“šæ–‡ç« ","item":"https://canw0916.github.io/en/posts/"},{"@type":"ListItem","position":2,"name":"ğŸš€ æŠ€æœ¯","item":"https://canw0916.github.io/en/posts/tech/"},{"@type":"ListItem","position":3,"name":"Requestsé«˜çº§","item":"https://canw0916.github.io/en/posts/tech/requests%E9%AB%98%E7%BA%A7/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Requestsé«˜çº§","name":"Requestsé«˜çº§","description":" ç®€å†æ¨¡æ¿ä¸‹è½½æ‹“å±•\nimport requests from lxml import etree import os headers = { \u0026#39;User-Agent\u0026#39;:\u0026#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36\u0026#39;, } #åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ dirName = \u0026#39;jianli\u0026#39; if not os.path.exists(dirName): os.mkdir(dirName) #é€šç”¨çš„urlæ¨¡æ¿ url = \u0026#39;https://sc.chinaz.com/jianli/free_%d.html\u0026#39; for page in range(1,11): if page == 1: new_url = \u0026#39;https://sc.chinaz.com/jianli/free.html\u0026#39; else: new_url = format(url%page) response = requests.get(url=new_url,headers=headers) response.encoding = \u0026#39;utf-8\u0026#39; page_text = response.text #æ•°æ®è§£æï¼šè¯¦æƒ…é¡µurlå’Œç®€å†åç§° tree = etree.HTML(page_text) div_list = tree.xpath(\u0026#39;//*[@id=\u0026#34;container\u0026#34;]/div\u0026#39;) #å±€éƒ¨è§£æ for div in div_list: detail_url = \u0026#39;https:\u0026#39;+div.xpath(\u0026#39;./a/@href\u0026#39;)[0] title = div.xpath(\u0026#39;./p/a/text()\u0026#39;)[0]+\u0026#39;.rar\u0026#39; # print(title,detail_url) #å¯¹è¯¦æƒ…é¡µçš„urlå‘èµ·è¯·æ±‚ï¼Œè§£æå‡ºç®€å†çš„ä¸‹è½½åœ°å€ detail_page_text = requests.get(url=detail_url,headers=headers).text #æ•°æ®è§£æï¼šè§£æä¸‹è½½åœ°å€ detail_tree = etree.HTML(detail_page_text) li_list = detail_tree.xpath(\u0026#39;//*[@id=\u0026#34;down\u0026#34;]/div[2]/ul/li\u0026#39;) down_list = [] #å­˜å‚¨ä¸åŒçš„12ä¸ªä¸‹è½½åœ°å€ for li in li_list: download_link = li.xpath(\u0026#39;./a/@href\u0026#39;)[0] down_list.append(download_link) #éšæœºé€‰æ‹©ä¸€ä¸ªä¸‹è½½åœ°å€è¿›è¡Œç®€å†æ¨¡æ¿çš„ä¸‹è½½ import random #ä»åˆ—è¡¨ä¸­éšæœºé€‰å‡ºä¸€ä¸ªä¸‹è½½åœ°å€ link = random.choice(down_list) #å¯¹ä¸‹è½½åœ°å€è¿›è¡Œè¯·æ±‚å‘é€ï¼Œä¸‹è½½ç®€å†æ¨¡æ¿çš„å‹ç¼©åŒ… data = requests.get(url=link,headers=headers).content filePath = dirName+\u0026#39;/\u0026#39;+title with open(filePath,\u0026#39;wb\u0026#39;) as fp: fp.write(data) print(title,\u0026#39;ä¸‹è½½ä¿å­˜æˆåŠŸï¼\u0026#39;) Cookie ä»€ä¹ˆæ˜¯cookieï¼Ÿ\n","keywords":[""],"articleBody":" ç®€å†æ¨¡æ¿ä¸‹è½½æ‹“å±•\nimport requests from lxml import etree import os headers = { 'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36', } #åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ dirName = 'jianli' if not os.path.exists(dirName): os.mkdir(dirName) #é€šç”¨çš„urlæ¨¡æ¿ url = 'https://sc.chinaz.com/jianli/free_%d.html' for page in range(1,11): if page == 1: new_url = 'https://sc.chinaz.com/jianli/free.html' else: new_url = format(url%page) response = requests.get(url=new_url,headers=headers) response.encoding = 'utf-8' page_text = response.text #æ•°æ®è§£æï¼šè¯¦æƒ…é¡µurlå’Œç®€å†åç§° tree = etree.HTML(page_text) div_list = tree.xpath('//*[@id=\"container\"]/div') #å±€éƒ¨è§£æ for div in div_list: detail_url = 'https:'+div.xpath('./a/@href')[0] title = div.xpath('./p/a/text()')[0]+'.rar' # print(title,detail_url) #å¯¹è¯¦æƒ…é¡µçš„urlå‘èµ·è¯·æ±‚ï¼Œè§£æå‡ºç®€å†çš„ä¸‹è½½åœ°å€ detail_page_text = requests.get(url=detail_url,headers=headers).text #æ•°æ®è§£æï¼šè§£æä¸‹è½½åœ°å€ detail_tree = etree.HTML(detail_page_text) li_list = detail_tree.xpath('//*[@id=\"down\"]/div[2]/ul/li') down_list = [] #å­˜å‚¨ä¸åŒçš„12ä¸ªä¸‹è½½åœ°å€ for li in li_list: download_link = li.xpath('./a/@href')[0] down_list.append(download_link) #éšæœºé€‰æ‹©ä¸€ä¸ªä¸‹è½½åœ°å€è¿›è¡Œç®€å†æ¨¡æ¿çš„ä¸‹è½½ import random #ä»åˆ—è¡¨ä¸­éšæœºé€‰å‡ºä¸€ä¸ªä¸‹è½½åœ°å€ link = random.choice(down_list) #å¯¹ä¸‹è½½åœ°å€è¿›è¡Œè¯·æ±‚å‘é€ï¼Œä¸‹è½½ç®€å†æ¨¡æ¿çš„å‹ç¼©åŒ… data = requests.get(url=link,headers=headers).content filePath = dirName+'/'+title with open(filePath,'wb') as fp: fp.write(data) print(title,'ä¸‹è½½ä¿å­˜æˆåŠŸï¼') Cookie ä»€ä¹ˆæ˜¯cookieï¼Ÿ\ncookieçš„æœ¬è´¨å°±æ˜¯ä¸€ç»„æ•°æ®ï¼ˆé”®å€¼å¯¹çš„å½¢å¼å­˜åœ¨ï¼‰ æ˜¯ç”±æœåŠ¡å™¨åˆ›å»ºï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæœ€ç»ˆä¼šä¿å­˜åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸­ã€‚ å¦‚æœå®¢æˆ·ç«¯ä¿å­˜äº†cookieï¼Œåˆ™ä¸‹æ¬¡å†æ¬¡è®¿é—®è¯¥æœåŠ¡å™¨ï¼Œå°±ä¼šæºå¸¦cookieè¿›è¡Œç½‘ç»œè®¿é—®ã€‚ å…¸å‹çš„æ¡ˆä¾‹ï¼šç½‘ç«™çš„å…å¯†ç™»å½• çˆ¬å–é›ªçƒç½‘ä¸­çš„å’¨è¯¢æ•°æ®\nurlï¼šhttps://xueqiu.com/ï¼Œéœ€æ±‚å°±æ˜¯çˆ¬å–çƒ­å¸–å†…å®¹\nç»è¿‡åˆ†æå‘ç°å¸–å­çš„å†…å®¹æ˜¯é€šè¿‡ajaxåŠ¨æ€åŠ è½½å‡ºæ¥çš„ï¼Œå› æ­¤é€šè¿‡æŠ“åŒ…å·¥å…·ï¼Œå®šä½åˆ°ajaxè¯·æ±‚çš„æ•°æ®åŒ…ï¼Œä»æ•°æ®åŒ…ä¸­æå–ï¼š\nurlï¼šhttps://xueqiu.com/statuses/hot/listV2.json?since_id=-1\u0026max_id=311519\u0026size=15 è¯·æ±‚æ–¹å¼ï¼šget è¯·æ±‚å‚æ•°ï¼šæ‹¼æ¥åœ¨äº†urlåé¢ import requests import os headers = { 'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36', } url = 'https://xueqiu.com/statuses/hot/listV2.json' param = { \"since_id\": \"-1\", \"max_id\": \"311519\", \"size\": \"15\", } response = requests.get(url=url,headers=headers,params=param) data = response.json() print(data) #å‘ç°æ²¡æœ‰æ‹¿åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°æ® åˆ†æwhyï¼Ÿ\nåˆ‡è®°ï¼šåªè¦çˆ¬è™«æ‹¿ä¸åˆ°ä½ æƒ³è¦çš„æ•°æ®ï¼Œå”¯ä¸€çš„åŸå› æ˜¯çˆ¬è™«ç¨‹åºæ¨¡æ‹Ÿæµè§ˆå™¨çš„åŠ›åº¦ä¸å¤Ÿï¼ä¸€èˆ¬æ¥è®²ï¼Œæ¨¡æ‹Ÿçš„åŠ›åº¦é‡ç‚¹æ”¾ç½®åœ¨è¯·æ±‚å¤´ä¸­ï¼ ä¸Šè¿°æ¡ˆä¾‹ï¼Œåªéœ€è¦åœ¨è¯·æ±‚å¤´headersä¸­æ·»åŠ cookieå³å¯ï¼ çˆ¬è™«ä¸­cookieçš„å¤„ç†æ–¹å¼ï¼ˆä¸¤ç§æ–¹å¼ï¼‰ï¼š\næ‰‹åŠ¨å¤„ç†ï¼šå°†æŠ“åŒ…å·¥å…·ä¸­çš„cookieèµ‹å€¼åˆ°headersä¸­å³å¯\nç¼ºç‚¹ï¼š ç¼–å†™éº»çƒ¦ cookieé€šå¸¸éƒ½ä¼šå­˜åœ¨æœ‰æ•ˆæ—¶é•¿ cookieä¸­å¯èƒ½ä¼šå­˜åœ¨å®æ—¶å˜åŒ–çš„å±€éƒ¨æ•°æ® è‡ªåŠ¨å¤„ç†\nåŸºäºsessionå¯¹è±¡å®ç°è‡ªåŠ¨å¤„ç†cookieã€‚\n1.åˆ›å»ºä¸€ä¸ªç©ºç™½çš„sessionå¯¹è±¡ã€‚ 2.éœ€è¦ä½¿ç”¨sessionå¯¹è±¡å‘èµ·è¯·æ±‚ï¼Œè¯·æ±‚çš„ç›®çš„æ˜¯ä¸ºäº†æ•è·cookie æ³¨æ„ï¼šå¦‚æœsessionå¯¹è±¡åœ¨å‘è¯·æ±‚çš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨ç«¯äº§ç”Ÿäº†cookieï¼Œåˆ™cookieä¼šè‡ªåŠ¨å­˜å‚¨åœ¨sessionå¯¹è±¡ä¸­ã€‚ 3.ä½¿ç”¨æºå¸¦cookieçš„sessionå¯¹è±¡ï¼Œå¯¹ç›®çš„ç½‘å€å‘èµ·è¯·æ±‚ï¼Œå°±å¯ä»¥å®ç°æºå¸¦cookieçš„è¯·æ±‚å‘é€ï¼Œä»è€Œè·å–æƒ³è¦çš„æ•°æ®ã€‚ æ³¨æ„ï¼šsessionå¯¹è±¡è‡³å°‘éœ€è¦å‘èµ·ä¸¤æ¬¡è¯·æ±‚\nç¬¬ä¸€æ¬¡è¯·æ±‚çš„ç›®çš„æ˜¯ä¸ºäº†æ•è·å­˜å‚¨cookieåˆ°sessionå¯¹è±¡ åæ¬¡çš„è¯·æ±‚ï¼Œå°±æ˜¯æºå¸¦cookieå‘èµ·çš„è¯·æ±‚äº† import requests #1.åˆ›å»ºä¸€ä¸ªç©ºç™½çš„sessionå¯¹è±¡ session = requests.Session() headers = { 'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36', } main_url = 'https://xueqiu.com/' #2.ä½¿ç”¨sessionå‘èµ·çš„è¯·æ±‚ï¼Œç›®çš„æ˜¯ä¸ºäº†æ•è·åˆ°cookieï¼Œä¸”å°†å…¶å­˜å‚¨åˆ°sessionå¯¹è±¡ä¸­ session.get(url=main_url,headers=headers) url = 'https://xueqiu.com/statuses/hot/listV2.json' param = { \"since_id\": \"-1\", \"max_id\": \"311519\", \"size\": \"15\", } #3.å°±æ˜¯ä½¿ç”¨æºå¸¦äº†cookieçš„sessionå¯¹è±¡å‘èµ·çš„è¯·æ±‚ï¼ˆå°±æ˜¯æºå¸¦è€…cookieå‘èµ·çš„è¯·æ±‚ï¼‰ response = session.get(url=url,headers=headers,params=param) data = response.json() print(data) ä»£ç† ä»€ä¹ˆæ˜¯ä»£ç† ä»£ç†æœåŠ¡å™¨ ä»£ç†æœåŠ¡å™¨çš„ä½œç”¨ å°±æ˜¯ç”¨æ¥è½¬å‘è¯·æ±‚å’Œå“åº” åœ¨çˆ¬è™«ä¸­ä¸ºä½•éœ€è¦ä½¿ç”¨ä»£ç†ï¼Ÿ\næœ‰äº›æ—¶å€™ï¼Œéœ€è¦å¯¹ç½‘ç«™æœåŠ¡å™¨å‘èµ·é«˜é¢‘çš„è¯·æ±‚ï¼Œç½‘ç«™çš„æœåŠ¡å™¨ä¼šæ£€æµ‹åˆ°è¿™æ ·çš„å¼‚å¸¸ç°è±¡ï¼Œåˆ™ä¼šè®²è¯·æ±‚å¯¹åº”æœºå™¨çš„ipåœ°å€åŠ å…¥é»‘åå•ï¼Œåˆ™è¯¥ipå†æ¬¡å‘èµ·çš„è¯·æ±‚ï¼Œç½‘ç«™æœåŠ¡å™¨å°±ä¸åœ¨å—ç†ï¼Œåˆ™æˆ‘ä»¬å°±æ— æ³•å†æ¬¡çˆ¬å–è¯¥ç½‘ç«™çš„æ•°æ®ã€‚ ä½¿ç”¨ä»£ç†åï¼Œç½‘ç«™æœåŠ¡å™¨æ¥æ”¶åˆ°çš„è¯·æ±‚ï¼Œæœ€ç»ˆæ˜¯ç”±ä»£ç†æœåŠ¡å™¨å‘èµ·ï¼Œç½‘ç«™æœåŠ¡å™¨é€šè¿‡è¯·æ±‚è·å–çš„ipå°±æ˜¯ä»£ç†æœåŠ¡å™¨çš„ipï¼Œå¹¶ä¸æ˜¯æˆ‘ä»¬å®¢æˆ·ç«¯æœ¬èº«çš„ipã€‚ ä»£ç†çš„åŒ¿ååº¦\né€æ˜ï¼šç½‘ç«™çš„æœåŠ¡å™¨çŸ¥é“ä½ ä½¿ç”¨äº†ä»£ç†ï¼Œä¹ŸçŸ¥é“ä½ çš„çœŸå®ip åŒ¿åï¼šç½‘ç«™æœåŠ¡å™¨çŸ¥é“ä½ ä½¿ç”¨äº†ä»£ç†ï¼Œä½†æ˜¯æ— æ³•è·çŸ¥ä½ çœŸå®çš„ip é«˜åŒ¿ï¼šç½‘ç«™æœåŠ¡å™¨ä¸çŸ¥é“ä½ ä½¿ç”¨äº†ä»£ç†ï¼Œä¹Ÿä¸çŸ¥é“ä½ çš„çœŸå®ipï¼ˆæ¨èï¼‰ ä»£ç†çš„ç±»å‹ï¼ˆé‡è¦ï¼‰\nhttpï¼šè¯¥ç±»å‹çš„ä»£ç†æœåŠ¡å™¨åªå¯ä»¥è½¬å‘httpåè®®çš„è¯·æ±‚ httpsï¼šå¯ä»¥è½¬å‘httpsåè®®çš„è¯·æ±‚ å¦‚ä½•è·å–ä»£ç†?\nä»£ç†ç²¾çµï¼šhttp://http.zhiliandaili.cn/ èŠéº»ä»£ç†ï¼šhttps://jahttp.zhimaruanjian.com/ï¼ˆæ¨èï¼Œæœ‰æ–°äººç¦åˆ©ï¼‰ å¦‚ä½•ä½¿ç”¨ä»£ç†ï¼Ÿ\næµ‹è¯•ï¼šè®¿é—®å¦‚ä¸‹ç½‘å€ï¼Œè¿”å›è‡ªå·±æœ¬æœºip\nimport requests from lxml import etree headers = { 'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36', } url = 'https://www.sogou.com/web?query=ip' page_text = requests.get(url=url,headers=headers).text tree = etree.HTML(page_text) data = tree.xpath('//*[@id=\"ipsearchresult\"]/strong/text()')[0] print(data) ä½¿ç”¨ä»£ç†å‘èµ·è¯·æ±‚ï¼ŒæŸ¥çœ‹æ˜¯å¦å¯ä»¥è¿”å›ä»£ç†æœåŠ¡å™¨çš„ip\nimport requests from lxml import etree headers = { 'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36', } url = 'https://www.sogou.com/web?query=ip' #ä½¿ç”¨ä»£ç†æœåŠ¡å™¨å‘èµ·è¯·æ±‚ #proxies={'ä»£ç†ç±»å‹':'ip:port'} page_text = requests.get(url=url,headers=headers,proxies={'https':'42.57.150.150:4278'}).text tree = etree.HTML(page_text) data = tree.xpath('//*[@id=\"ipsearchresult\"]/strong/text()')[0] print(data) æ·±åº¦æµ‹è¯•ï¼š\nå¯¹å¿«ä»£ç†è¿›è¡Œnæ¬¡è¯·æ±‚ï¼Œç›´åˆ°æœ¬æœºæ— æ³•è®¿é—®å¿«ä»£ç†ä¸ºæ­¢ï¼ˆè¯æ˜æœ¬æœºipè¢«å¿«ä»£ç†å°æ‰äº†ï¼‰\næ„å»ºä¸€ä¸ªä»£ç†æ± ï¼ˆå°è£…äº†å¾ˆå¤šä»£ç†ipå’Œç«¯å£çš„å®¹å™¨ï¼‰ï¼Œç”¨äºæ•°æ®çš„æ‰¹é‡çˆ¬å–\nfrom bs4 import BeautifulSoup from lxml import etree import requests import time import random headers = { 'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36' } #æ„å»ºä¸€ä¸ªä»£ç†æ±  proxy_url = 'http://webapi.http.zhimacangku.com/getip?num=15\u0026type=2\u0026pro=\u0026city=0\u0026yys=0\u0026port=1\u0026pack=213751\u0026ts=0\u0026ys=0\u0026cs=0\u0026lb=6\u0026sb=-\u0026pb=4\u0026mr=1\u0026regions=' json_data = requests.get(url=proxy_url,headers=headers).json() json_list = json_data['data'] proxy_list = [] #ä»£ç†æ± ,æ¯æ¬¡è¯·æ±‚ï¼Œå¯ä»¥éšæœºä»ä»£ç†æ± ä¸­é€‰æ‹©ä¸€ä¸ªä»£ç†æ¥ç”¨ for dic in json_list: ip = dic['ip'] port = dic['port'] n_dic = { 'https':ip+':'+str(port) # {'https':'111.1.1.1:1234'} } proxy_list.append(n_dic) #çˆ¬å–å¤šé¡µ #1.åˆ›å»ºä¸€ä¸ªé€šç”¨çš„url(å¯ä»¥å˜æ¢æˆä»»æ„é¡µç çš„url) url = 'https://www.kuaidaili.com/free/inha/%d/' #2.é€šè¿‡å¾ªç¯ä»¥æ­¤ç”Ÿæˆä¸åŒé¡µç çš„url for page in range(1,4): print('----------æ­£åœ¨çˆ¬å–ç¬¬%dé¡µçš„æ•°æ®ï¼-----------'%page) #formatç”¨æ¥æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ï¼ˆä¸å¯ä»¥ä¿®æ”¹urlè¿™ä¸ªå­—ç¬¦ä¸²æœ¬èº«ï¼‰ new_url = format(url%page) #å¾ªç¯å‘é€æ¯ä¸€é¡µçš„è¯·æ±‚ #æ³¨æ„ï¼šgetæ–¹æ³•æ˜¯ä¸€ä¸ªé˜»å¡æ–¹æ³•ï¼ page_text = requests.get(url=new_url,headers=headers,proxies=random.choice(proxy_list)).text time.sleep(1) soup = BeautifulSoup(page_text,'lxml') trs = soup.select('tbody \u003e tr') for tr in trs: t1 = tr.findAll('td')[0] t2 = tr.findAll('td')[1] ip = t1.string port = t2.string print(ip,port) éªŒè¯ç  å›¾é‰´å¹³å°ï¼šhttp://www.ttshitu.com/ ï¼ˆæ¨èï¼‰\nè¶…çº§é¹°ï¼šhttps://www.chaojiying.com/about.html\nä½¿ç”¨å›¾é‰´è¯†åˆ«å¤è¯—æ–‡ç½‘ç™»å½•ä¸­çš„éªŒè¯ç \nå¤è¯—æ–‡ç½‘ï¼šhttps://so.gushiwen.cn/user/login.aspx?from=http://so.gushiwen.cn/user/collect.aspx\nä½¿ç”¨æµç¨‹ï¼š\næ³¨å†Œç™»å½•å›¾é‰´å¹³å°\nç™»å½•åï¼Œç‚¹å‡»å¼€å‘æ–‡æ¡£ï¼Œæå–è¯†åˆ«çš„æºä»£ç \næ¨¡å—(tujian.py)çš„å°è£…ï¼š\nimport base64 import json import requests # ä¸€ã€å›¾ç‰‡æ–‡å­—ç±»å‹(é»˜è®¤ 3 æ•°è‹±æ··åˆ)ï¼š # 1 : çº¯æ•°å­— # 1001ï¼šçº¯æ•°å­—2 # 2 : çº¯è‹±æ–‡ # 1002ï¼šçº¯è‹±æ–‡2 # 3 : æ•°è‹±æ··åˆ # 1003ï¼šæ•°è‹±æ··åˆ2 # 4 : é—ªåŠ¨GIF # 7 : æ— æ„Ÿå­¦ä¹ (ç‹¬å®¶) # 11 : è®¡ç®—é¢˜ # 1005: å¿«é€Ÿè®¡ç®—é¢˜ # 16 : æ±‰å­— # 32 : é€šç”¨æ–‡å­—è¯†åˆ«(è¯ä»¶ã€å•æ®) # 66: é—®ç­”é¢˜ # 49 :recaptchaå›¾ç‰‡è¯†åˆ« # äºŒã€å›¾ç‰‡æ—‹è½¬è§’åº¦ç±»å‹ï¼š # 29 : æ—‹è½¬ç±»å‹ # # ä¸‰ã€å›¾ç‰‡åæ ‡ç‚¹é€‰ç±»å‹ï¼š # 19 : 1ä¸ªåæ ‡ # 20 : 3ä¸ªåæ ‡ # 21 : 3 ~ 5ä¸ªåæ ‡ # 22 : 5 ~ 8ä¸ªåæ ‡ # 27 : 1 ~ 4ä¸ªåæ ‡ # 48 : è½¨è¿¹ç±»å‹ # # å››ã€ç¼ºå£è¯†åˆ« # 18 : ç¼ºå£è¯†åˆ«ï¼ˆéœ€è¦2å¼ å›¾ ä¸€å¼ ç›®æ ‡å›¾ä¸€å¼ ç¼ºå£å›¾ï¼‰ # 33 : å•ç¼ºå£è¯†åˆ«ï¼ˆè¿”å›Xè½´åæ ‡ åªéœ€è¦1å¼ å›¾ï¼‰ # äº”ã€æ‹¼å›¾è¯†åˆ« # 53ï¼šæ‹¼å›¾è¯†åˆ« #å‡½æ•°å®ç°å¿½ç•¥ def base64_api(uname, pwd, img, typeid): with open(img, 'rb') as f: base64_data = base64.b64encode(f.read()) b64 = base64_data.decode() data = {\"username\": uname, \"password\": pwd, \"typeid\": typeid, \"image\": b64} result = json.loads(requests.post(\"http://api.ttshitu.com/predict\", json=data).text) if result['success']: return result[\"data\"][\"result\"] else: return result[\"message\"] return \"\" def getImgCodeText(imgPath,imgType):#ç›´æ¥è¿”å›éªŒè¯ç å†…å®¹ #imgPathï¼šéªŒè¯ç å›¾ç‰‡åœ°å€ #imgTypeï¼šéªŒè¯ç å›¾ç‰‡ç±»å‹ result = base64_api(uname='bb328410948', pwd='bb328410948', img=imgPath, typeid=imgType) return result éªŒè¯ç å›¾ç‰‡è¯†åˆ«æ“ä½œ\nfrom lxml import etree import requests import tujian headers = { 'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36' } #å°†éªŒè¯ç å›¾ç‰‡è¯·æ±‚åä¿å­˜åˆ°æœ¬åœ° login_url = 'https://so.gushiwen.cn/user/login.aspx?from=http://so.gushiwen.cn/user/collect.aspx' page_text = requests.get(url=login_url,headers=headers).text tree = etree.HTML(page_text) img_src = 'https://so.gushiwen.cn'+tree.xpath('//*[@id=\"imgCode\"]/@src')[0] code_data = requests.get(url=img_src,headers=headers).content with open('./code.jpg','wb') as fp: fp.write(code_data) #è¯†åˆ«éªŒè¯ç å›¾ç‰‡å†…å®¹ result = tujian.getImgCodeText('./code.jpg',3) print(result) æ¨¡æ‹Ÿç™»å½• å¤è¯—æ–‡ç½‘\nåœ¨æŠ“åŒ…å·¥å…·é‡Œå®šä½ç‚¹å‡»ç™»å½•æŒ‰é’®åå¯¹åº”çš„æ•°æ®åŒ…ï¼š\nåªè¦æ•°æ®åŒ…çš„è¯·æ±‚å‚æ•°ä¸­åŒ…å«ç”¨æˆ·åï¼Œå¯†ç å’ŒéªŒè¯ç åˆ™è¯¥æ•°æ®åŒ…å°±æ˜¯æˆ‘ä»¬è¦å®šä½çš„\né¦–æ¬¡æ¨¡æ‹Ÿç™»å½•æ“ä½œï¼š\nfrom lxml import etree import requests import tujian headers = { 'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36' } #å°†éªŒè¯ç å›¾ç‰‡è¯·æ±‚åä¿å­˜åˆ°æœ¬åœ° login_url = 'https://so.gushiwen.cn/user/login.aspx?from=http://so.gushiwen.cn/user/collect.aspx' page_text = requests.get(url=login_url,headers=headers).text tree = etree.HTML(page_text) img_src = 'https://so.gushiwen.cn'+tree.xpath('//*[@id=\"imgCode\"]/@src')[0] code_data = requests.get(url=img_src,headers=headers).content with open('./code.jpg','wb') as fp: fp.write(code_data) #è¯†åˆ«éªŒè¯ç å›¾ç‰‡å†…å®¹ result = tujian.getImgCodeText('./code.jpg',3) print(result) #æ¨¡æ‹Ÿç™»å½• url = 'https://so.gushiwen.cn/user/login.aspx?from=http%3a%2f%2fso.gushiwen.cn%2fuser%2fcollect.aspx' data = { \"__VIEWSTATE\": \"opfVI7oolwkr7MLRVzsNSMASqLRUuO1dg5ZP5EIRa4FyM+mOYKEs6KWEKQKaba2ulLoZQIaLFiKK4mr5K3ci1v8ua28wtcRtabKWjOtJtU/i2etH+zSduegTMcg=\", \"__VIEWSTATEGENERATOR\": \"C93BE1AE\", \"from\": \"http://so.gushiwen.cn/user/collect.aspx\", \"email\": \"15027900535\", \"pwd\": \"bobo@15027900535\", \"code\":result , \"denglu\": \"ç™»å½•\" } #è·å–äº†ç™»å½•æˆåŠŸåçš„é¡µé¢æºç æ•°æ® login_page_text = requests.post(url=url,headers=headers,data=data).text with open('wushiwen.html','w') as fp: fp.write(login_page_text) æŸ¥çœ‹gushiwen.htmlå‘ç°ï¼Œæ²¡æœ‰ç™»å½•æˆåŠŸï¼ŒåŸå› ï¼š\néªŒè¯ç ä¸å¯¹ï¼ˆå¦å®šï¼‰\næ²¡æœ‰æºå¸¦cookie\nå‡ºç°äº†åŠ¨æ€å˜åŒ–çš„è¯·æ±‚å‚æ•°\nå¦‚ä½•è·å–åŠ¨æ€å˜åŒ–çš„è¯·æ±‚å‚æ•° åŸºäºæŠ“åŒ…å·¥å…·è¿›è¡Œå…¨å±€æœç´¢ï¼Œå‘ç°è¯¥å‚æ•°å€¼è¢«éšè—åœ¨äº†ç™»å½•é¡µé¢çš„é¡µé¢æºç ä¸­ from lxml import etree import requests import tujian headers = { 'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36' } #åˆ›å»ºsessionå¯¹è±¡ session = requests.Session() #å°†éªŒè¯ç å›¾ç‰‡è¯·æ±‚åä¿å­˜åˆ°æœ¬åœ° login_url = 'https://so.gushiwen.cn/user/login.aspx?from=http://so.gushiwen.cn/user/collect.aspx' page_text = session.get(url=login_url,headers=headers).text tree = etree.HTML(page_text) img_src = 'https://so.gushiwen.cn'+tree.xpath('//*[@id=\"imgCode\"]/@src')[0] code_data = session.get(url=img_src,headers=headers).content with open('./code.jpg','wb') as fp: fp.write(code_data) #è§£æå‡ºåŠ¨æ€å˜åŒ–çš„è¯·æ±‚å‚æ•° __VIEWSTATE = tree.xpath('//*[@id=\"__VIEWSTATE\"]/@value')[0] #è¯†åˆ«éªŒè¯ç å›¾ç‰‡å†…å®¹ result = tujian.getImgCodeText('./code.jpg',3) print(result) #æ¨¡æ‹Ÿç™»å½• url = 'https://so.gushiwen.cn/user/login.aspx?from=http%3a%2f%2fso.gushiwen.cn%2fuser%2fcollect.aspx' data = { \"__VIEWSTATE\": __VIEWSTATE, \"__VIEWSTATEGENERATOR\": \"C93BE1AE\", \"from\": \"http://so.gushiwen.cn/user/collect.aspx\", \"email\": \"15027900535\", \"pwd\": \"bobo@15027900535\", \"code\":result , \"denglu\": \"ç™»å½•\" } #è·å–äº†ç™»å½•æˆåŠŸåçš„é¡µé¢æºç æ•°æ® login_page_text = session.post(url=url,headers=headers,data=data).text with open('wushiwen.html','w') as fp: fp.write(login_page_text) é˜²ç›—é“¾ ç°åœ¨å¾ˆå¤šç½‘ç«™å¯ç”¨äº†é˜²ç›—é“¾åçˆ¬ï¼Œé˜²æ­¢æœåŠ¡å™¨ä¸Šçš„èµ„æºè¢«äººæ¶æ„ç›—å–ã€‚ä»€ä¹ˆæ˜¯é˜²ç›—é“¾å‘¢ï¼Ÿ\nä»¥å›¾ç‰‡ä¸ºä¾‹ï¼Œè®¿é—®å›¾ç‰‡è¦ä»ä»–çš„ç½‘ç«™è®¿é—®æ‰å¯ä»¥ï¼Œå¦åˆ™ç›´æ¥è®¿é—®å›¾ç‰‡åœ°å€å¾—ä¸åˆ°å›¾ç‰‡ ç»ƒä¹ ï¼šæŠ“å–å¾®åšå›¾ç‰‡ï¼Œurlï¼šhttp://blog.sina.com.cn/lm/pic/ï¼Œå°†é¡µé¢ä¸­æŸä¸€ç»„ç³»åˆ—è¯¦æƒ…é¡µçš„å›¾ç‰‡è¿›è¡ŒæŠ“å–ä¿å­˜ï¼Œæ¯”å¦‚ä¸‰é‡Œå±¯æ—¶å°šå¥³éƒï¼šhttp://blog.sina.com.cn/s/blog_01ebcb8a0102zi2o.html?tj=1\næ³¨æ„ï¼š\n1.åœ¨è§£æå›¾ç‰‡åœ°å€çš„æ—¶å€™ï¼Œå®šä½srcçš„å±æ€§å€¼ï¼Œè¿”å›çš„å†…å®¹å’Œå¼€å‘å·¥å…·Elementä¸­çœ‹åˆ°çš„ä¸ä¸€æ ·ï¼Œé€šè¿‡networkæŸ¥çœ‹ç½‘é¡µæºç å‘ç°éœ€è¦è§£æreal_srcçš„å€¼ã€‚\n2.ç›´æ¥è¯·æ±‚real_srcè¯·æ±‚åˆ°çš„å›¾ç‰‡ä¸æ˜¾ç¤ºï¼ŒåŠ ä¸ŠRefereè¯·æ±‚å¤´å³å¯\nå“ªé‡Œæ‰¾Refereï¼šæŠ“åŒ…å·¥å…·å®šä½åˆ°æŸä¸€å¼ å›¾ç‰‡æ•°æ®åŒ…ï¼Œåœ¨å…¶requests headersä¸­è·å– import requests from lxml import etree headers = { 'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36', \"Referer\": \"http://blog.sina.com.cn/\", } url = 'http://blog.sina.com.cn/s/blog_01ebcb8a0102zi2o.html?tj=1' page_text = requests.get(url,headers=headers).text tree = etree.HTML(page_text) img_src = tree.xpath('//*[@id=\"sina_keyword_ad_area2\"]/div/a/img/@real_src') for src in img_src: data = requests.get(src,headers=headers).content with open('./123.jpg','wb') as fp: fp.write(data) # break å›¾ç‰‡æ‡’åŠ è½½(ä½œä¸š) urlï¼šhttps://sc.chinaz.com/tupian/meinvtupian.html çˆ¬å–ä¸Šè¿°é“¾æ¥ä¸­æ‰€æœ‰çš„å›¾ç‰‡æ•°æ® å›¾ç‰‡æ‡’åŠ è½½ï¼š ä¸»è¦æ˜¯åº”ç”¨åœ¨å±•ç¤ºå›¾ç‰‡çš„ç½‘é¡µä¸­çš„ä¸€ç§æŠ€æœ¯ï¼Œè¯¥æŠ€æœ¯æ˜¯æŒ‡å½“ç½‘é¡µåˆ·æ–°åï¼Œå…ˆåŠ è½½å±€éƒ¨çš„å‡ å¼ å›¾ç‰‡æ•°æ®å³å¯ï¼Œéšç€ç”¨æˆ·æ»‘åŠ¨æ»šè½®ï¼Œå½“å›¾ç‰‡è¢«æ˜¾ç¤ºåœ¨æµè§ˆå™¨çš„å¯è§†åŒ–åŒºåŸŸèŒƒå›´çš„è¯ï¼Œåœ¨åŠ¨æ€å°†å…¶å›¾ç‰‡è¯·æ±‚åŠ è½½å‡ºæ¥å³å¯ã€‚ï¼ˆå›¾ç‰‡æ•°æ®æ˜¯åŠ¨æ€åŠ è½½å‡ºæ¥ï¼‰ã€‚ å¦‚ä½•å®ç°å›¾ç‰‡æ‡’åŠ è½½/åŠ¨æ€åŠ è½½ï¼Ÿ ä½¿ç”¨imgæ ‡ç­¾çš„ä¼ªå±æ€§ï¼ˆæŒ‡çš„æ˜¯è‡ªå®šä¹‰çš„ä¸€ç§å±æ€§ï¼‰ã€‚åœ¨ç½‘é¡µä¸­ï¼Œä¸ºäº†é˜²æ­¢å›¾ç‰‡é©¬ä¸ŠåŠ è½½å‡ºæ¥ï¼Œåˆ™åœ¨imgæ ‡ç­¾ä¸­å¯ä»¥ä½¿ç”¨ä¸€ç§ä¼ªå±æ€§æ¥å­˜å‚¨å›¾ç‰‡çš„é“¾æ¥ï¼Œè€Œä¸æ˜¯ä½¿ç”¨çœŸæ­£çš„srcå±æ€§å€¼æ¥å­˜å‚¨å›¾ç‰‡é“¾æ¥ã€‚ï¼ˆå›¾ç‰‡é“¾æ¥ä¸€æ—¦ç»™äº†srcå±æ€§ï¼Œåˆ™å›¾ç‰‡ä¼šè¢«ç«‹å³åŠ è½½å‡ºæ¥ï¼‰ã€‚åªæœ‰å½“å›¾ç‰‡è¢«æ»‘åŠ¨åˆ°æµè§ˆå™¨å¯è§†åŒ–åŒºåŸŸèŒƒå›´çš„æ—¶å€™ï¼Œåœ¨é€šè¿‡jså°†imgçš„ä¼ªå±æ€§ä¿®æ”¹ä¸ºçœŸæ­£çš„srcå±æ€§ï¼Œåˆ™å›¾ç‰‡å°±ä¼šè¢«åŠ è½½å‡ºæ¥ã€‚ å¦‚ä½•çˆ¬å–å›¾ç‰‡æ‡’åŠ è½½çš„å›¾ç‰‡æ•°æ®ï¼Ÿ åªéœ€è¦åœ¨è§£æå›¾ç‰‡çš„æ—¶å€™ï¼Œå®šä½ä¼ªå±æ€§ï¼ˆsrc2ï¼‰çš„å±æ€§å€¼å³å¯ã€‚ ","wordCount":"4409","inLanguage":"en","datePublished":"2023-02-10T14:04:30+08:00","dateModified":"2023-02-10T14:04:30+08:00","author":[{"@type":"Person","name":"Felix"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://canw0916.github.io/en/posts/tech/requests%E9%AB%98%E7%BA%A7/"},"publisher":{"@type":"Organization","name":"Felix's Blog","logo":{"@type":"ImageObject","url":"https://canw0916.github.io/img/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><script async src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script><header class=header><nav class=nav><div class=logo><a href=https://canw0916.github.io/en/ accesskey=h title="Felix's Blog (Alt + H)"><img src=https://canw0916.github.io/img/android-chrome-512x512.png alt=logo aria-label=logo height=35>Felix's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://canw0916.github.io/en/search title="ğŸ” æœç´¢ (Alt + /)" accesskey=/><span>ğŸ” æœç´¢</span></a></li><li><a href=https://canw0916.github.io/en/ title="ğŸ  ä¸»é¡µ"><span>ğŸ  ä¸»é¡µ</span></a></li><li><a href=https://canw0916.github.io/en/posts title="ğŸ“š æ–‡ç« "><span>ğŸ“š æ–‡ç« </span></a></li><li><a href=https://canw0916.github.io/en/tags title="ğŸ’¡ æ ‡ç­¾"><span>ğŸ’¡ æ ‡ç­¾</span></a></li><li><a href=https://canw0916.github.io/en/archives/ title="â±ï¸ æ—¶é—´è½´"><span>â±ï¸ æ—¶é—´è½´</span></a></li><li><a href=https://canw0916.github.io/en/about title="ğŸ‘¦ å…³äº"><span>ğŸ‘¦ å…³äº</span></a></li><li><a href=https://canw0916.github.io/en/links title="ğŸ˜º å‹é“¾"><span>ğŸ˜º å‹é“¾</span></a></li></ul></nav></header><main class="main page"><article class=post-single><div id=single-content><header class=post-header><div class=breadcrumbs><a href=https://canw0916.github.io/en/>ğŸ ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href=https://canw0916.github.io/en/posts/>ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href=https://canw0916.github.io/en/posts/tech/>ğŸš€ æŠ€æœ¯</a></div><h1 class=post-title>Requestsé«˜çº§</h1><div class=post-meta>åˆ›å»º:2023-02-10|å­—æ•°:4409å­—|æ—¶é•¿: 9åˆ†é’Ÿ|
ä½œè€…:Felix
&nbsp;&nbsp;æ ‡ç­¾: &nbsp;<ul class=post-tags-meta><a href=https://canw0916.github.io/en/tags/python/>Python</a></ul><span id=busuanzi_container_page_pv>&nbsp;| è®¿é—®: <span id=busuanzi_value_page_pv></span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>æ–‡ç« ç›®å½•</span></summary><div class=inner><ul><li><a href=#cookie aria-label=Cookie>Cookie</a></li><li><a href=#%e4%bb%a3%e7%90%86 aria-label=ä»£ç†>ä»£ç†</a></li><li><a href=#%e9%aa%8c%e8%af%81%e7%a0%81 aria-label=éªŒè¯ç >éªŒè¯ç </a></li><li><a href=#%e6%a8%a1%e6%8b%9f%e7%99%bb%e5%bd%95 aria-label=æ¨¡æ‹Ÿç™»å½•>æ¨¡æ‹Ÿç™»å½•</a></li><li><a href=#%e9%98%b2%e7%9b%97%e9%93%be aria-label=é˜²ç›—é“¾>é˜²ç›—é“¾</a></li><li><a href=#%e5%9b%be%e7%89%87%e6%87%92%e5%8a%a0%e8%bd%bd%e4%bd%9c%e4%b8%9a aria-label=å›¾ç‰‡æ‡’åŠ è½½(ä½œä¸š)>å›¾ç‰‡æ‡’åŠ è½½(ä½œä¸š)</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><ul><li><p>ç®€å†æ¨¡æ¿ä¸‹è½½æ‹“å±•</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>lxml</span> <span class=kn>import</span> <span class=n>etree</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>  <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span><span class=s1>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>#åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹</span>
</span></span><span class=line><span class=cl>  <span class=n>dirName</span> <span class=o>=</span> <span class=s1>&#39;jianli&#39;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>dirName</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=n>os</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>dirName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>#é€šç”¨çš„urlæ¨¡æ¿</span>
</span></span><span class=line><span class=cl>  <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;https://sc.chinaz.com/jianli/free_</span><span class=si>%d</span><span class=s1>.html&#39;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>page</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>11</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=n>page</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>          <span class=n>new_url</span> <span class=o>=</span> <span class=s1>&#39;https://sc.chinaz.com/jianli/free.html&#39;</span>
</span></span><span class=line><span class=cl>      <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>          <span class=n>new_url</span> <span class=o>=</span> <span class=nb>format</span><span class=p>(</span><span class=n>url</span><span class=o>%</span><span class=n>page</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>new_url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>response</span><span class=o>.</span><span class=n>encoding</span> <span class=o>=</span> <span class=s1>&#39;utf-8&#39;</span>
</span></span><span class=line><span class=cl>      <span class=n>page_text</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>      <span class=c1>#æ•°æ®è§£æï¼šè¯¦æƒ…é¡µurlå’Œç®€å†åç§°</span>
</span></span><span class=line><span class=cl>      <span class=n>tree</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>HTML</span><span class=p>(</span><span class=n>page_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>div_list</span> <span class=o>=</span> <span class=n>tree</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;container&#34;]/div&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=c1>#å±€éƒ¨è§£æ</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=n>div</span> <span class=ow>in</span> <span class=n>div_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>          <span class=n>detail_url</span> <span class=o>=</span> <span class=s1>&#39;https:&#39;</span><span class=o>+</span><span class=n>div</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;./a/@href&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>          <span class=n>title</span> <span class=o>=</span> <span class=n>div</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;./p/a/text()&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span><span class=o>+</span><span class=s1>&#39;.rar&#39;</span>
</span></span><span class=line><span class=cl>          <span class=c1># print(title,detail_url)</span>
</span></span><span class=line><span class=cl>          <span class=c1>#å¯¹è¯¦æƒ…é¡µçš„urlå‘èµ·è¯·æ±‚ï¼Œè§£æå‡ºç®€å†çš„ä¸‹è½½åœ°å€</span>
</span></span><span class=line><span class=cl>          <span class=n>detail_page_text</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>detail_url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>          <span class=c1>#æ•°æ®è§£æï¼šè§£æä¸‹è½½åœ°å€</span>
</span></span><span class=line><span class=cl>          <span class=n>detail_tree</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>HTML</span><span class=p>(</span><span class=n>detail_page_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=n>li_list</span> <span class=o>=</span> <span class=n>detail_tree</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;down&#34;]/div[2]/ul/li&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=n>down_list</span> <span class=o>=</span> <span class=p>[]</span> <span class=c1>#å­˜å‚¨ä¸åŒçš„12ä¸ªä¸‹è½½åœ°å€</span>
</span></span><span class=line><span class=cl>          <span class=k>for</span> <span class=n>li</span> <span class=ow>in</span> <span class=n>li_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>              <span class=n>download_link</span> <span class=o>=</span> <span class=n>li</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;./a/@href&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>              <span class=n>down_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>download_link</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=c1>#éšæœºé€‰æ‹©ä¸€ä¸ªä¸‹è½½åœ°å€è¿›è¡Œç®€å†æ¨¡æ¿çš„ä¸‹è½½</span>
</span></span><span class=line><span class=cl>          <span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>          <span class=c1>#ä»åˆ—è¡¨ä¸­éšæœºé€‰å‡ºä¸€ä¸ªä¸‹è½½åœ°å€</span>
</span></span><span class=line><span class=cl>          <span class=n>link</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>down_list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=c1>#å¯¹ä¸‹è½½åœ°å€è¿›è¡Œè¯·æ±‚å‘é€ï¼Œä¸‹è½½ç®€å†æ¨¡æ¿çš„å‹ç¼©åŒ…</span>
</span></span><span class=line><span class=cl>          <span class=n>data</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>link</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span><span class=o>.</span><span class=n>content</span>
</span></span><span class=line><span class=cl>          <span class=n>filePath</span> <span class=o>=</span> <span class=n>dirName</span><span class=o>+</span><span class=s1>&#39;/&#39;</span><span class=o>+</span><span class=n>title</span>
</span></span><span class=line><span class=cl>          <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>filePath</span><span class=p>,</span><span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>fp</span><span class=p>:</span>
</span></span><span class=line><span class=cl>              <span class=n>fp</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nb>print</span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=s1>&#39;ä¸‹è½½ä¿å­˜æˆåŠŸï¼&#39;</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><h3 id=cookie>Cookie<a hidden class=anchor aria-hidden=true href=#cookie>#</a></h3><ul><li><p>ä»€ä¹ˆæ˜¯cookieï¼Ÿ</p><ul><li>cookieçš„æœ¬è´¨å°±æ˜¯ä¸€ç»„æ•°æ®ï¼ˆé”®å€¼å¯¹çš„å½¢å¼å­˜åœ¨ï¼‰</li><li>æ˜¯ç”±æœåŠ¡å™¨åˆ›å»ºï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæœ€ç»ˆä¼šä¿å­˜åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸­ã€‚</li><li>å¦‚æœå®¢æˆ·ç«¯ä¿å­˜äº†cookieï¼Œåˆ™ä¸‹æ¬¡å†æ¬¡è®¿é—®è¯¥æœåŠ¡å™¨ï¼Œå°±ä¼šæºå¸¦cookieè¿›è¡Œç½‘ç»œè®¿é—®ã€‚<ul><li>å…¸å‹çš„æ¡ˆä¾‹ï¼šç½‘ç«™çš„å…å¯†ç™»å½•</li></ul></li></ul></li><li><p>çˆ¬å–é›ªçƒç½‘ä¸­çš„å’¨è¯¢æ•°æ®</p><ul><li><p>urlï¼šhttps://xueqiu.com/ï¼Œéœ€æ±‚å°±æ˜¯çˆ¬å–çƒ­å¸–å†…å®¹</p></li><li><p>ç»è¿‡åˆ†æå‘ç°å¸–å­çš„å†…å®¹æ˜¯é€šè¿‡ajaxåŠ¨æ€åŠ è½½å‡ºæ¥çš„ï¼Œå› æ­¤é€šè¿‡æŠ“åŒ…å·¥å…·ï¼Œå®šä½åˆ°ajaxè¯·æ±‚çš„æ•°æ®åŒ…ï¼Œä»æ•°æ®åŒ…ä¸­æå–ï¼š</p><ul><li>urlï¼šhttps://xueqiu.com/statuses/hot/listV2.json?since_id=-1&amp;max_id=311519&amp;size=15</li><li>è¯·æ±‚æ–¹å¼ï¼šget</li><li>è¯·æ±‚å‚æ•°ï¼šæ‹¼æ¥åœ¨äº†urlåé¢</li></ul></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>  <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span><span class=s1>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;https://xueqiu.com/statuses/hot/listV2.json&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>param</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;since_id&#34;</span><span class=p>:</span> <span class=s2>&#34;-1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;max_id&#34;</span><span class=p>:</span> <span class=s2>&#34;311519&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;size&#34;</span><span class=p>:</span> <span class=s2>&#34;15&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span><span class=n>params</span><span class=o>=</span><span class=n>param</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>data</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>#å‘ç°æ²¡æœ‰æ‹¿åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°æ®</span>
</span></span></code></pre></div></li><li><p>åˆ†æwhyï¼Ÿ</p><ul><li>åˆ‡è®°ï¼šåªè¦çˆ¬è™«æ‹¿ä¸åˆ°ä½ æƒ³è¦çš„æ•°æ®ï¼Œå”¯ä¸€çš„åŸå› æ˜¯çˆ¬è™«ç¨‹åºæ¨¡æ‹Ÿæµè§ˆå™¨çš„åŠ›åº¦ä¸å¤Ÿï¼ä¸€èˆ¬æ¥è®²ï¼Œæ¨¡æ‹Ÿçš„åŠ›åº¦é‡ç‚¹æ”¾ç½®åœ¨è¯·æ±‚å¤´ä¸­ï¼</li><li>ä¸Šè¿°æ¡ˆä¾‹ï¼Œåªéœ€è¦åœ¨è¯·æ±‚å¤´headersä¸­æ·»åŠ cookieå³å¯ï¼</li></ul></li><li><p>çˆ¬è™«ä¸­cookieçš„å¤„ç†æ–¹å¼ï¼ˆä¸¤ç§æ–¹å¼ï¼‰ï¼š</p><ul><li><p>æ‰‹åŠ¨å¤„ç†ï¼šå°†æŠ“åŒ…å·¥å…·ä¸­çš„cookieèµ‹å€¼åˆ°headersä¸­å³å¯</p><ul><li>ç¼ºç‚¹ï¼š<ul><li>ç¼–å†™éº»çƒ¦</li><li>cookieé€šå¸¸éƒ½ä¼šå­˜åœ¨æœ‰æ•ˆæ—¶é•¿</li><li>cookieä¸­å¯èƒ½ä¼šå­˜åœ¨å®æ—¶å˜åŒ–çš„å±€éƒ¨æ•°æ®</li></ul></li></ul></li><li><p>è‡ªåŠ¨å¤„ç†</p><ul><li><p>åŸºäºsessionå¯¹è±¡å®ç°è‡ªåŠ¨å¤„ç†cookieã€‚</p><ul><li>1.åˆ›å»ºä¸€ä¸ªç©ºç™½çš„sessionå¯¹è±¡ã€‚</li><li>2.éœ€è¦ä½¿ç”¨sessionå¯¹è±¡å‘èµ·è¯·æ±‚ï¼Œè¯·æ±‚çš„ç›®çš„æ˜¯ä¸ºäº†æ•è·cookie<ul><li>æ³¨æ„ï¼šå¦‚æœsessionå¯¹è±¡åœ¨å‘è¯·æ±‚çš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨ç«¯äº§ç”Ÿäº†cookieï¼Œåˆ™cookieä¼šè‡ªåŠ¨å­˜å‚¨åœ¨sessionå¯¹è±¡ä¸­ã€‚</li></ul></li><li>3.ä½¿ç”¨æºå¸¦cookieçš„sessionå¯¹è±¡ï¼Œå¯¹ç›®çš„ç½‘å€å‘èµ·è¯·æ±‚ï¼Œå°±å¯ä»¥å®ç°æºå¸¦cookieçš„è¯·æ±‚å‘é€ï¼Œä»è€Œè·å–æƒ³è¦çš„æ•°æ®ã€‚</li></ul></li><li><p>æ³¨æ„ï¼šsessionå¯¹è±¡è‡³å°‘éœ€è¦å‘èµ·ä¸¤æ¬¡è¯·æ±‚</p><ul><li>ç¬¬ä¸€æ¬¡è¯·æ±‚çš„ç›®çš„æ˜¯ä¸ºäº†æ•è·å­˜å‚¨cookieåˆ°sessionå¯¹è±¡</li><li>åæ¬¡çš„è¯·æ±‚ï¼Œå°±æ˜¯æºå¸¦cookieå‘èµ·çš„è¯·æ±‚äº†</li></ul></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>  <span class=c1>#1.åˆ›å»ºä¸€ä¸ªç©ºç™½çš„sessionå¯¹è±¡</span>
</span></span><span class=line><span class=cl>  <span class=n>session</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span><span class=s1>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>main_url</span> <span class=o>=</span> <span class=s1>&#39;https://xueqiu.com/&#39;</span>
</span></span><span class=line><span class=cl>  <span class=c1>#2.ä½¿ç”¨sessionå‘èµ·çš„è¯·æ±‚ï¼Œç›®çš„æ˜¯ä¸ºäº†æ•è·åˆ°cookieï¼Œä¸”å°†å…¶å­˜å‚¨åˆ°sessionå¯¹è±¡ä¸­</span>
</span></span><span class=line><span class=cl>  <span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>main_url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;https://xueqiu.com/statuses/hot/listV2.json&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>param</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;since_id&#34;</span><span class=p>:</span> <span class=s2>&#34;-1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;max_id&#34;</span><span class=p>:</span> <span class=s2>&#34;311519&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;size&#34;</span><span class=p>:</span> <span class=s2>&#34;15&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>#3.å°±æ˜¯ä½¿ç”¨æºå¸¦äº†cookieçš„sessionå¯¹è±¡å‘èµ·çš„è¯·æ±‚ï¼ˆå°±æ˜¯æºå¸¦è€…cookieå‘èµ·çš„è¯·æ±‚ï¼‰</span>
</span></span><span class=line><span class=cl>  <span class=n>response</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span><span class=n>params</span><span class=o>=</span><span class=n>param</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>data</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span></code></pre></div></li></ul></li></ul></li></ul></li></ul><h3 id=ä»£ç†>ä»£ç†<a hidden class=anchor aria-hidden=true href=#ä»£ç†>#</a></h3><ul><li>ä»€ä¹ˆæ˜¯ä»£ç†<ul><li>ä»£ç†æœåŠ¡å™¨</li></ul></li><li>ä»£ç†æœåŠ¡å™¨çš„ä½œç”¨<ul><li>å°±æ˜¯ç”¨æ¥è½¬å‘è¯·æ±‚å’Œå“åº”</li></ul></li></ul><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/canw0916/picgo_imgs@main/blog/Snip20220124_45.png alt=Snip20220124_45></p><ul><li><p>åœ¨çˆ¬è™«ä¸­ä¸ºä½•éœ€è¦ä½¿ç”¨ä»£ç†ï¼Ÿ</p><ul><li>æœ‰äº›æ—¶å€™ï¼Œéœ€è¦å¯¹ç½‘ç«™æœåŠ¡å™¨å‘èµ·é«˜é¢‘çš„è¯·æ±‚ï¼Œç½‘ç«™çš„æœåŠ¡å™¨ä¼šæ£€æµ‹åˆ°è¿™æ ·çš„å¼‚å¸¸ç°è±¡ï¼Œåˆ™ä¼šè®²è¯·æ±‚å¯¹åº”æœºå™¨çš„ipåœ°å€åŠ å…¥é»‘åå•ï¼Œåˆ™è¯¥ipå†æ¬¡å‘èµ·çš„è¯·æ±‚ï¼Œç½‘ç«™æœåŠ¡å™¨å°±ä¸åœ¨å—ç†ï¼Œåˆ™æˆ‘ä»¬å°±æ— æ³•å†æ¬¡çˆ¬å–è¯¥ç½‘ç«™çš„æ•°æ®ã€‚</li><li>ä½¿ç”¨ä»£ç†åï¼Œç½‘ç«™æœåŠ¡å™¨æ¥æ”¶åˆ°çš„è¯·æ±‚ï¼Œæœ€ç»ˆæ˜¯ç”±ä»£ç†æœåŠ¡å™¨å‘èµ·ï¼Œç½‘ç«™æœåŠ¡å™¨é€šè¿‡è¯·æ±‚è·å–çš„ipå°±æ˜¯ä»£ç†æœåŠ¡å™¨çš„ipï¼Œå¹¶ä¸æ˜¯æˆ‘ä»¬å®¢æˆ·ç«¯æœ¬èº«çš„ipã€‚</li></ul></li><li><p>ä»£ç†çš„åŒ¿ååº¦</p><ul><li>é€æ˜ï¼šç½‘ç«™çš„æœåŠ¡å™¨çŸ¥é“ä½ ä½¿ç”¨äº†ä»£ç†ï¼Œä¹ŸçŸ¥é“ä½ çš„çœŸå®ip</li><li>åŒ¿åï¼šç½‘ç«™æœåŠ¡å™¨çŸ¥é“ä½ ä½¿ç”¨äº†ä»£ç†ï¼Œä½†æ˜¯æ— æ³•è·çŸ¥ä½ çœŸå®çš„ip</li><li>é«˜åŒ¿ï¼šç½‘ç«™æœåŠ¡å™¨ä¸çŸ¥é“ä½ ä½¿ç”¨äº†ä»£ç†ï¼Œä¹Ÿä¸çŸ¥é“ä½ çš„çœŸå®ipï¼ˆæ¨èï¼‰</li></ul></li><li><p>ä»£ç†çš„ç±»å‹ï¼ˆé‡è¦ï¼‰</p><ul><li>httpï¼šè¯¥ç±»å‹çš„ä»£ç†æœåŠ¡å™¨åªå¯ä»¥è½¬å‘httpåè®®çš„è¯·æ±‚</li><li>httpsï¼šå¯ä»¥è½¬å‘httpsåè®®çš„è¯·æ±‚</li></ul></li><li><p>å¦‚ä½•è·å–ä»£ç†?</p><ul><li>ä»£ç†ç²¾çµï¼šhttp://http.zhiliandaili.cn/</li><li>èŠéº»ä»£ç†ï¼šhttps://jahttp.zhimaruanjian.com/ï¼ˆæ¨èï¼Œæœ‰æ–°äººç¦åˆ©ï¼‰</li></ul></li><li><p>å¦‚ä½•ä½¿ç”¨ä»£ç†ï¼Ÿ</p><ul><li><p>æµ‹è¯•ï¼šè®¿é—®å¦‚ä¸‹ç½‘å€ï¼Œè¿”å›è‡ªå·±æœ¬æœºip</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>lxml</span> <span class=kn>import</span> <span class=n>etree</span>
</span></span><span class=line><span class=cl>  <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span><span class=s1>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;https://www.sogou.com/web?query=ip&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>page_text</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>  <span class=n>tree</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>HTML</span><span class=p>(</span><span class=n>page_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>data</span> <span class=o>=</span> <span class=n>tree</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;ipsearchresult&#34;]/strong/text()&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>ä½¿ç”¨ä»£ç†å‘èµ·è¯·æ±‚ï¼ŒæŸ¥çœ‹æ˜¯å¦å¯ä»¥è¿”å›ä»£ç†æœåŠ¡å™¨çš„ip</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>lxml</span> <span class=kn>import</span> <span class=n>etree</span>
</span></span><span class=line><span class=cl>  <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span><span class=s1>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;https://www.sogou.com/web?query=ip&#39;</span>
</span></span><span class=line><span class=cl>  <span class=c1>#ä½¿ç”¨ä»£ç†æœåŠ¡å™¨å‘èµ·è¯·æ±‚</span>
</span></span><span class=line><span class=cl>  <span class=c1>#proxies={&#39;ä»£ç†ç±»å‹&#39;:&#39;ip:port&#39;}</span>
</span></span><span class=line><span class=cl>  <span class=n>page_text</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span><span class=n>proxies</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;https&#39;</span><span class=p>:</span><span class=s1>&#39;42.57.150.150:4278&#39;</span><span class=p>})</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>  <span class=n>tree</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>HTML</span><span class=p>(</span><span class=n>page_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>data</span> <span class=o>=</span> <span class=n>tree</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;ipsearchresult&#34;]/strong/text()&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>æ·±åº¦æµ‹è¯•ï¼š</p><ul><li><p>å¯¹å¿«ä»£ç†è¿›è¡Œnæ¬¡è¯·æ±‚ï¼Œç›´åˆ°æœ¬æœºæ— æ³•è®¿é—®å¿«ä»£ç†ä¸ºæ­¢ï¼ˆè¯æ˜æœ¬æœºipè¢«å¿«ä»£ç†å°æ‰äº†ï¼‰</p></li><li><p>æ„å»ºä¸€ä¸ªä»£ç†æ± ï¼ˆå°è£…äº†å¾ˆå¤šä»£ç†ipå’Œç«¯å£çš„å®¹å™¨ï¼‰ï¼Œç”¨äºæ•°æ®çš„æ‰¹é‡çˆ¬å–</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>bs4</span> <span class=kn>import</span> <span class=n>BeautifulSoup</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>lxml</span> <span class=kn>import</span> <span class=n>etree</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>  <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span><span class=s1>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>#æ„å»ºä¸€ä¸ªä»£ç†æ± </span>
</span></span><span class=line><span class=cl>  <span class=n>proxy_url</span> <span class=o>=</span> <span class=s1>&#39;http://webapi.http.zhimacangku.com/getip?num=15&amp;type=2&amp;pro=&amp;city=0&amp;yys=0&amp;port=1&amp;pack=213751&amp;ts=0&amp;ys=0&amp;cs=0&amp;lb=6&amp;sb=-&amp;pb=4&amp;mr=1&amp;regions=&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>json_data</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>proxy_url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>json_list</span> <span class=o>=</span> <span class=n>json_data</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=n>proxy_list</span> <span class=o>=</span> <span class=p>[]</span> <span class=c1>#ä»£ç†æ± ,æ¯æ¬¡è¯·æ±‚ï¼Œå¯ä»¥éšæœºä»ä»£ç†æ± ä¸­é€‰æ‹©ä¸€ä¸ªä»£ç†æ¥ç”¨</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>dic</span> <span class=ow>in</span> <span class=n>json_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>ip</span> <span class=o>=</span> <span class=n>dic</span><span class=p>[</span><span class=s1>&#39;ip&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=n>port</span> <span class=o>=</span> <span class=n>dic</span><span class=p>[</span><span class=s1>&#39;port&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=n>n_dic</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=s1>&#39;https&#39;</span><span class=p>:</span><span class=n>ip</span><span class=o>+</span><span class=s1>&#39;:&#39;</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>port</span><span class=p>)</span> <span class=c1># {&#39;https&#39;:&#39;111.1.1.1:1234&#39;}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=n>proxy_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>n_dic</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>#çˆ¬å–å¤šé¡µ</span>
</span></span><span class=line><span class=cl>  <span class=c1>#1.åˆ›å»ºä¸€ä¸ªé€šç”¨çš„url(å¯ä»¥å˜æ¢æˆä»»æ„é¡µç çš„url)</span>
</span></span><span class=line><span class=cl>  <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;https://www.kuaidaili.com/free/inha/</span><span class=si>%d</span><span class=s1>/&#39;</span>
</span></span><span class=line><span class=cl>  <span class=c1>#2.é€šè¿‡å¾ªç¯ä»¥æ­¤ç”Ÿæˆä¸åŒé¡µç çš„url</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>page</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;----------æ­£åœ¨çˆ¬å–ç¬¬</span><span class=si>%d</span><span class=s1>é¡µçš„æ•°æ®ï¼-----------&#39;</span><span class=o>%</span><span class=n>page</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=c1>#formatç”¨æ¥æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ï¼ˆä¸å¯ä»¥ä¿®æ”¹urlè¿™ä¸ªå­—ç¬¦ä¸²æœ¬èº«ï¼‰</span>
</span></span><span class=line><span class=cl>      <span class=n>new_url</span> <span class=o>=</span> <span class=nb>format</span><span class=p>(</span><span class=n>url</span><span class=o>%</span><span class=n>page</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=c1>#å¾ªç¯å‘é€æ¯ä¸€é¡µçš„è¯·æ±‚</span>
</span></span><span class=line><span class=cl>      <span class=c1>#æ³¨æ„ï¼šgetæ–¹æ³•æ˜¯ä¸€ä¸ªé˜»å¡æ–¹æ³•ï¼</span>
</span></span><span class=line><span class=cl>      <span class=n>page_text</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>new_url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span><span class=n>proxies</span><span class=o>=</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>proxy_list</span><span class=p>))</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>      <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>soup</span> <span class=o>=</span> <span class=n>BeautifulSoup</span><span class=p>(</span><span class=n>page_text</span><span class=p>,</span><span class=s1>&#39;lxml&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>trs</span> <span class=o>=</span> <span class=n>soup</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=s1>&#39;tbody &gt; tr&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=n>tr</span> <span class=ow>in</span> <span class=n>trs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>          <span class=n>t1</span> <span class=o>=</span> <span class=n>tr</span><span class=o>.</span><span class=n>findAll</span><span class=p>(</span><span class=s1>&#39;td&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>          <span class=n>t2</span> <span class=o>=</span> <span class=n>tr</span><span class=o>.</span><span class=n>findAll</span><span class=p>(</span><span class=s1>&#39;td&#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>          <span class=n>ip</span> <span class=o>=</span> <span class=n>t1</span><span class=o>.</span><span class=n>string</span>
</span></span><span class=line><span class=cl>          <span class=n>port</span> <span class=o>=</span> <span class=n>t2</span><span class=o>.</span><span class=n>string</span>
</span></span><span class=line><span class=cl>          <span class=nb>print</span><span class=p>(</span><span class=n>ip</span><span class=p>,</span><span class=n>port</span><span class=p>)</span>
</span></span></code></pre></div></li></ul></li></ul></li></ul><h3 id=éªŒè¯ç >éªŒè¯ç <a hidden class=anchor aria-hidden=true href=#éªŒè¯ç >#</a></h3><ul><li><p>å›¾é‰´å¹³å°ï¼šhttp://www.ttshitu.com/ ï¼ˆæ¨èï¼‰</p></li><li><p>è¶…çº§é¹°ï¼šhttps://www.chaojiying.com/about.html</p></li><li><p>ä½¿ç”¨å›¾é‰´è¯†åˆ«å¤è¯—æ–‡ç½‘ç™»å½•ä¸­çš„éªŒè¯ç </p><ul><li><p>å¤è¯—æ–‡ç½‘ï¼šhttps://so.gushiwen.cn/user/login.aspx?from=http://so.gushiwen.cn/user/collect.aspx</p></li><li><p>ä½¿ç”¨æµç¨‹ï¼š</p><ul><li><p>æ³¨å†Œç™»å½•å›¾é‰´å¹³å°</p></li><li><p>ç™»å½•åï¼Œç‚¹å‡»å¼€å‘æ–‡æ¡£ï¼Œæå–è¯†åˆ«çš„æºä»£ç </p></li><li><p>æ¨¡å—(tujian.py)çš„å°è£…ï¼š</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>  <span class=c1># ä¸€ã€å›¾ç‰‡æ–‡å­—ç±»å‹(é»˜è®¤ 3 æ•°è‹±æ··åˆ)ï¼š</span>
</span></span><span class=line><span class=cl>  <span class=c1># 1 : çº¯æ•°å­—</span>
</span></span><span class=line><span class=cl>  <span class=c1># 1001ï¼šçº¯æ•°å­—2</span>
</span></span><span class=line><span class=cl>  <span class=c1># 2 : çº¯è‹±æ–‡</span>
</span></span><span class=line><span class=cl>  <span class=c1># 1002ï¼šçº¯è‹±æ–‡2</span>
</span></span><span class=line><span class=cl>  <span class=c1># 3 : æ•°è‹±æ··åˆ</span>
</span></span><span class=line><span class=cl>  <span class=c1># 1003ï¼šæ•°è‹±æ··åˆ2</span>
</span></span><span class=line><span class=cl>  <span class=c1>#  4 : é—ªåŠ¨GIF</span>
</span></span><span class=line><span class=cl>  <span class=c1># 7 : æ— æ„Ÿå­¦ä¹ (ç‹¬å®¶)</span>
</span></span><span class=line><span class=cl>  <span class=c1># 11 : è®¡ç®—é¢˜</span>
</span></span><span class=line><span class=cl>  <span class=c1># 1005:  å¿«é€Ÿè®¡ç®—é¢˜</span>
</span></span><span class=line><span class=cl>  <span class=c1># 16 : æ±‰å­—</span>
</span></span><span class=line><span class=cl>  <span class=c1># 32 : é€šç”¨æ–‡å­—è¯†åˆ«(è¯ä»¶ã€å•æ®)</span>
</span></span><span class=line><span class=cl>  <span class=c1># 66:  é—®ç­”é¢˜</span>
</span></span><span class=line><span class=cl>  <span class=c1># 49 :recaptchaå›¾ç‰‡è¯†åˆ«</span>
</span></span><span class=line><span class=cl>  <span class=c1># äºŒã€å›¾ç‰‡æ—‹è½¬è§’åº¦ç±»å‹ï¼š</span>
</span></span><span class=line><span class=cl>  <span class=c1># 29 :  æ—‹è½¬ç±»å‹</span>
</span></span><span class=line><span class=cl>  <span class=c1>#</span>
</span></span><span class=line><span class=cl>  <span class=c1># ä¸‰ã€å›¾ç‰‡åæ ‡ç‚¹é€‰ç±»å‹ï¼š</span>
</span></span><span class=line><span class=cl>  <span class=c1># 19 :  1ä¸ªåæ ‡</span>
</span></span><span class=line><span class=cl>  <span class=c1># 20 :  3ä¸ªåæ ‡</span>
</span></span><span class=line><span class=cl>  <span class=c1># 21 :  3 ~ 5ä¸ªåæ ‡</span>
</span></span><span class=line><span class=cl>  <span class=c1># 22 :  5 ~ 8ä¸ªåæ ‡</span>
</span></span><span class=line><span class=cl>  <span class=c1># 27 :  1 ~ 4ä¸ªåæ ‡</span>
</span></span><span class=line><span class=cl>  <span class=c1># 48 : è½¨è¿¹ç±»å‹</span>
</span></span><span class=line><span class=cl>  <span class=c1>#</span>
</span></span><span class=line><span class=cl>  <span class=c1># å››ã€ç¼ºå£è¯†åˆ«</span>
</span></span><span class=line><span class=cl>  <span class=c1># 18 : ç¼ºå£è¯†åˆ«ï¼ˆéœ€è¦2å¼ å›¾ ä¸€å¼ ç›®æ ‡å›¾ä¸€å¼ ç¼ºå£å›¾ï¼‰</span>
</span></span><span class=line><span class=cl>  <span class=c1># 33 : å•ç¼ºå£è¯†åˆ«ï¼ˆè¿”å›Xè½´åæ ‡ åªéœ€è¦1å¼ å›¾ï¼‰</span>
</span></span><span class=line><span class=cl>  <span class=c1># äº”ã€æ‹¼å›¾è¯†åˆ«</span>
</span></span><span class=line><span class=cl>  <span class=c1># 53ï¼šæ‹¼å›¾è¯†åˆ«</span>
</span></span><span class=line><span class=cl>  <span class=c1>#å‡½æ•°å®ç°å¿½ç•¥</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>base64_api</span><span class=p>(</span><span class=n>uname</span><span class=p>,</span> <span class=n>pwd</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=n>typeid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>          <span class=n>base64_data</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span></span><span class=line><span class=cl>          <span class=n>b64</span> <span class=o>=</span> <span class=n>base64_data</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;username&#34;</span><span class=p>:</span> <span class=n>uname</span><span class=p>,</span> <span class=s2>&#34;password&#34;</span><span class=p>:</span> <span class=n>pwd</span><span class=p>,</span> <span class=s2>&#34;typeid&#34;</span><span class=p>:</span> <span class=n>typeid</span><span class=p>,</span> <span class=s2>&#34;image&#34;</span><span class=p>:</span> <span class=n>b64</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=n>result</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&#34;http://api.ttshitu.com/predict&#34;</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>data</span><span class=p>)</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;success&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=n>result</span><span class=p>[</span><span class=s2>&#34;data&#34;</span><span class=p>][</span><span class=s2>&#34;result&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=n>result</span><span class=p>[</span><span class=s2>&#34;message&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>getImgCodeText</span><span class=p>(</span><span class=n>imgPath</span><span class=p>,</span><span class=n>imgType</span><span class=p>):</span><span class=c1>#ç›´æ¥è¿”å›éªŒè¯ç å†…å®¹</span>
</span></span><span class=line><span class=cl>      <span class=c1>#imgPathï¼šéªŒè¯ç å›¾ç‰‡åœ°å€</span>
</span></span><span class=line><span class=cl>      <span class=c1>#imgTypeï¼šéªŒè¯ç å›¾ç‰‡ç±»å‹</span>
</span></span><span class=line><span class=cl>      <span class=n>result</span> <span class=o>=</span> <span class=n>base64_api</span><span class=p>(</span><span class=n>uname</span><span class=o>=</span><span class=s1>&#39;bb328410948&#39;</span><span class=p>,</span> <span class=n>pwd</span><span class=o>=</span><span class=s1>&#39;bb328410948&#39;</span><span class=p>,</span> <span class=n>img</span><span class=o>=</span><span class=n>imgPath</span><span class=p>,</span> <span class=n>typeid</span><span class=o>=</span><span class=n>imgType</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>result</span>
</span></span></code></pre></div></li><li><p>éªŒè¯ç å›¾ç‰‡è¯†åˆ«æ“ä½œ</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>lxml</span> <span class=kn>import</span> <span class=n>etree</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>tujian</span>
</span></span><span class=line><span class=cl>  <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span><span class=s1>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>#å°†éªŒè¯ç å›¾ç‰‡è¯·æ±‚åä¿å­˜åˆ°æœ¬åœ°</span>
</span></span><span class=line><span class=cl>  <span class=n>login_url</span> <span class=o>=</span> <span class=s1>&#39;https://so.gushiwen.cn/user/login.aspx?from=http://so.gushiwen.cn/user/collect.aspx&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>page_text</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>login_url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>  <span class=n>tree</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>HTML</span><span class=p>(</span><span class=n>page_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>img_src</span> <span class=o>=</span> <span class=s1>&#39;https://so.gushiwen.cn&#39;</span><span class=o>+</span><span class=n>tree</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;imgCode&#34;]/@src&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=n>code_data</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>img_src</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span><span class=o>.</span><span class=n>content</span>
</span></span><span class=line><span class=cl>  <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./code.jpg&#39;</span><span class=p>,</span><span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>fp</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>fp</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>code_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>#è¯†åˆ«éªŒè¯ç å›¾ç‰‡å†…å®¹</span>
</span></span><span class=line><span class=cl>  <span class=n>result</span> <span class=o>=</span> <span class=n>tujian</span><span class=o>.</span><span class=n>getImgCodeText</span><span class=p>(</span><span class=s1>&#39;./code.jpg&#39;</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span></code></pre></div></li></ul></li></ul></li></ul><h3 id=æ¨¡æ‹Ÿç™»å½•>æ¨¡æ‹Ÿç™»å½•<a hidden class=anchor aria-hidden=true href=#æ¨¡æ‹Ÿç™»å½•>#</a></h3><ul><li><p>å¤è¯—æ–‡ç½‘</p></li><li><p>åœ¨æŠ“åŒ…å·¥å…·é‡Œå®šä½ç‚¹å‡»ç™»å½•æŒ‰é’®åå¯¹åº”çš„æ•°æ®åŒ…ï¼š</p><ul><li><p>åªè¦æ•°æ®åŒ…çš„è¯·æ±‚å‚æ•°ä¸­åŒ…å«ç”¨æˆ·åï¼Œå¯†ç å’ŒéªŒè¯ç åˆ™è¯¥æ•°æ®åŒ…å°±æ˜¯æˆ‘ä»¬è¦å®šä½çš„</p></li><li><p>é¦–æ¬¡æ¨¡æ‹Ÿç™»å½•æ“ä½œï¼š</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>lxml</span> <span class=kn>import</span> <span class=n>etree</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>tujian</span>
</span></span><span class=line><span class=cl>  <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span><span class=s1>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>#å°†éªŒè¯ç å›¾ç‰‡è¯·æ±‚åä¿å­˜åˆ°æœ¬åœ°</span>
</span></span><span class=line><span class=cl>  <span class=n>login_url</span> <span class=o>=</span> <span class=s1>&#39;https://so.gushiwen.cn/user/login.aspx?from=http://so.gushiwen.cn/user/collect.aspx&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>page_text</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>login_url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>  <span class=n>tree</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>HTML</span><span class=p>(</span><span class=n>page_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>img_src</span> <span class=o>=</span> <span class=s1>&#39;https://so.gushiwen.cn&#39;</span><span class=o>+</span><span class=n>tree</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;imgCode&#34;]/@src&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=n>code_data</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>img_src</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span><span class=o>.</span><span class=n>content</span>
</span></span><span class=line><span class=cl>  <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./code.jpg&#39;</span><span class=p>,</span><span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>fp</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>fp</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>code_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>#è¯†åˆ«éªŒè¯ç å›¾ç‰‡å†…å®¹</span>
</span></span><span class=line><span class=cl>  <span class=n>result</span> <span class=o>=</span> <span class=n>tujian</span><span class=o>.</span><span class=n>getImgCodeText</span><span class=p>(</span><span class=s1>&#39;./code.jpg&#39;</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>#æ¨¡æ‹Ÿç™»å½•</span>
</span></span><span class=line><span class=cl>  <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;https://so.gushiwen.cn/user/login.aspx?from=http</span><span class=si>%3a%2f%2f</span><span class=s1>so.gushiwen.cn</span><span class=si>%2f</span><span class=s1>user</span><span class=si>%2f</span><span class=s1>collect.aspx&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;__VIEWSTATE&#34;</span><span class=p>:</span> <span class=s2>&#34;opfVI7oolwkr7MLRVzsNSMASqLRUuO1dg5ZP5EIRa4FyM+mOYKEs6KWEKQKaba2ulLoZQIaLFiKK4mr5K3ci1v8ua28wtcRtabKWjOtJtU/i2etH+zSduegTMcg=&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;__VIEWSTATEGENERATOR&#34;</span><span class=p>:</span> <span class=s2>&#34;C93BE1AE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;from&#34;</span><span class=p>:</span> <span class=s2>&#34;http://so.gushiwen.cn/user/collect.aspx&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;email&#34;</span><span class=p>:</span> <span class=s2>&#34;15027900535&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;pwd&#34;</span><span class=p>:</span> <span class=s2>&#34;bobo@15027900535&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;code&#34;</span><span class=p>:</span><span class=n>result</span> <span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;denglu&#34;</span><span class=p>:</span> <span class=s2>&#34;ç™»å½•&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>#è·å–äº†ç™»å½•æˆåŠŸåçš„é¡µé¢æºç æ•°æ®</span>
</span></span><span class=line><span class=cl>  <span class=n>login_page_text</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>  <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;wushiwen.html&#39;</span><span class=p>,</span><span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>fp</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>fp</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>login_page_text</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>æŸ¥çœ‹gushiwen.htmlå‘ç°ï¼Œæ²¡æœ‰ç™»å½•æˆåŠŸï¼ŒåŸå› ï¼š</p><ul><li><p>éªŒè¯ç ä¸å¯¹ï¼ˆå¦å®šï¼‰</p></li><li><p>æ²¡æœ‰æºå¸¦cookie</p></li><li><p>å‡ºç°äº†åŠ¨æ€å˜åŒ–çš„è¯·æ±‚å‚æ•°</p><ul><li>å¦‚ä½•è·å–åŠ¨æ€å˜åŒ–çš„è¯·æ±‚å‚æ•°<ul><li>åŸºäºæŠ“åŒ…å·¥å…·è¿›è¡Œå…¨å±€æœç´¢ï¼Œå‘ç°è¯¥å‚æ•°å€¼è¢«éšè—åœ¨äº†ç™»å½•é¡µé¢çš„é¡µé¢æºç ä¸­</li></ul></li></ul></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>lxml</span> <span class=kn>import</span> <span class=n>etree</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>tujian</span>
</span></span><span class=line><span class=cl>  <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span><span class=s1>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>#åˆ›å»ºsessionå¯¹è±¡</span>
</span></span><span class=line><span class=cl>  <span class=n>session</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>#å°†éªŒè¯ç å›¾ç‰‡è¯·æ±‚åä¿å­˜åˆ°æœ¬åœ°</span>
</span></span><span class=line><span class=cl>  <span class=n>login_url</span> <span class=o>=</span> <span class=s1>&#39;https://so.gushiwen.cn/user/login.aspx?from=http://so.gushiwen.cn/user/collect.aspx&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>page_text</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>login_url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>  <span class=n>tree</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>HTML</span><span class=p>(</span><span class=n>page_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>img_src</span> <span class=o>=</span> <span class=s1>&#39;https://so.gushiwen.cn&#39;</span><span class=o>+</span><span class=n>tree</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;imgCode&#34;]/@src&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=n>code_data</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>img_src</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span><span class=o>.</span><span class=n>content</span>
</span></span><span class=line><span class=cl>  <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./code.jpg&#39;</span><span class=p>,</span><span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>fp</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>fp</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>code_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>#è§£æå‡ºåŠ¨æ€å˜åŒ–çš„è¯·æ±‚å‚æ•°</span>
</span></span><span class=line><span class=cl>  <span class=n>__VIEWSTATE</span> <span class=o>=</span> <span class=n>tree</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;__VIEWSTATE&#34;]/@value&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>#è¯†åˆ«éªŒè¯ç å›¾ç‰‡å†…å®¹</span>
</span></span><span class=line><span class=cl>  <span class=n>result</span> <span class=o>=</span> <span class=n>tujian</span><span class=o>.</span><span class=n>getImgCodeText</span><span class=p>(</span><span class=s1>&#39;./code.jpg&#39;</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>#æ¨¡æ‹Ÿç™»å½•</span>
</span></span><span class=line><span class=cl>  <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;https://so.gushiwen.cn/user/login.aspx?from=http</span><span class=si>%3a%2f%2f</span><span class=s1>so.gushiwen.cn</span><span class=si>%2f</span><span class=s1>user</span><span class=si>%2f</span><span class=s1>collect.aspx&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;__VIEWSTATE&#34;</span><span class=p>:</span> <span class=n>__VIEWSTATE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;__VIEWSTATEGENERATOR&#34;</span><span class=p>:</span> <span class=s2>&#34;C93BE1AE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;from&#34;</span><span class=p>:</span> <span class=s2>&#34;http://so.gushiwen.cn/user/collect.aspx&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;email&#34;</span><span class=p>:</span> <span class=s2>&#34;15027900535&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;pwd&#34;</span><span class=p>:</span> <span class=s2>&#34;bobo@15027900535&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;code&#34;</span><span class=p>:</span><span class=n>result</span> <span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;denglu&#34;</span><span class=p>:</span> <span class=s2>&#34;ç™»å½•&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>#è·å–äº†ç™»å½•æˆåŠŸåçš„é¡µé¢æºç æ•°æ®</span>
</span></span><span class=line><span class=cl>  <span class=n>login_page_text</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>  <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;wushiwen.html&#39;</span><span class=p>,</span><span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>fp</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>fp</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>login_page_text</span><span class=p>)</span>
</span></span></code></pre></div></li></ul></li></ul></li></ul><h3 id=é˜²ç›—é“¾>é˜²ç›—é“¾<a hidden class=anchor aria-hidden=true href=#é˜²ç›—é“¾>#</a></h3><ul><li><p>ç°åœ¨å¾ˆå¤šç½‘ç«™å¯ç”¨äº†é˜²ç›—é“¾åçˆ¬ï¼Œé˜²æ­¢æœåŠ¡å™¨ä¸Šçš„èµ„æºè¢«äººæ¶æ„ç›—å–ã€‚ä»€ä¹ˆæ˜¯é˜²ç›—é“¾å‘¢ï¼Ÿ</p><ul><li>ä»¥å›¾ç‰‡ä¸ºä¾‹ï¼Œè®¿é—®å›¾ç‰‡è¦ä»ä»–çš„ç½‘ç«™è®¿é—®æ‰å¯ä»¥ï¼Œå¦åˆ™ç›´æ¥è®¿é—®å›¾ç‰‡åœ°å€å¾—ä¸åˆ°å›¾ç‰‡</li></ul></li><li><p>ç»ƒä¹ ï¼šæŠ“å–å¾®åšå›¾ç‰‡ï¼Œurlï¼šhttp://blog.sina.com.cn/lm/pic/ï¼Œå°†é¡µé¢ä¸­æŸä¸€ç»„ç³»åˆ—è¯¦æƒ…é¡µçš„å›¾ç‰‡è¿›è¡ŒæŠ“å–ä¿å­˜ï¼Œæ¯”å¦‚ä¸‰é‡Œå±¯æ—¶å°šå¥³éƒï¼šhttp://blog.sina.com.cn/s/blog_01ebcb8a0102zi2o.html?tj=1</p><ul><li><p>æ³¨æ„ï¼š</p><ul><li><p>1.åœ¨è§£æå›¾ç‰‡åœ°å€çš„æ—¶å€™ï¼Œå®šä½srcçš„å±æ€§å€¼ï¼Œè¿”å›çš„å†…å®¹å’Œå¼€å‘å·¥å…·Elementä¸­çœ‹åˆ°çš„ä¸ä¸€æ ·ï¼Œé€šè¿‡networkæŸ¥çœ‹ç½‘é¡µæºç å‘ç°éœ€è¦è§£æreal_srcçš„å€¼ã€‚</p></li><li><p>2.ç›´æ¥è¯·æ±‚real_srcè¯·æ±‚åˆ°çš„å›¾ç‰‡ä¸æ˜¾ç¤ºï¼ŒåŠ ä¸ŠRefereè¯·æ±‚å¤´å³å¯</p><ul><li>å“ªé‡Œæ‰¾Refereï¼šæŠ“åŒ…å·¥å…·å®šä½åˆ°æŸä¸€å¼ å›¾ç‰‡æ•°æ®åŒ…ï¼Œåœ¨å…¶requests headersä¸­è·å–</li></ul></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>lxml</span> <span class=kn>import</span> <span class=n>etree</span>
</span></span><span class=line><span class=cl>  <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span><span class=s1>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;Referer&#34;</span><span class=p>:</span> <span class=s2>&#34;http://blog.sina.com.cn/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://blog.sina.com.cn/s/blog_01ebcb8a0102zi2o.html?tj=1&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>page_text</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>  <span class=n>tree</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>HTML</span><span class=p>(</span><span class=n>page_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>img_src</span> <span class=o>=</span> <span class=n>tree</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;sina_keyword_ad_area2&#34;]/div/a/img/@real_src&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>src</span> <span class=ow>in</span> <span class=n>img_src</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>data</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>src</span><span class=p>,</span><span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span><span class=o>.</span><span class=n>content</span>
</span></span><span class=line><span class=cl>      <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./123.jpg&#39;</span><span class=p>,</span><span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>fp</span><span class=p>:</span>
</span></span><span class=line><span class=cl>          <span class=n>fp</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=c1># break</span>
</span></span></code></pre></div></li></ul></li></ul></li></ul><h3 id=å›¾ç‰‡æ‡’åŠ è½½ä½œä¸š>å›¾ç‰‡æ‡’åŠ è½½(ä½œä¸š)<a hidden class=anchor aria-hidden=true href=#å›¾ç‰‡æ‡’åŠ è½½ä½œä¸š>#</a></h3><ul><li>urlï¼šhttps://sc.chinaz.com/tupian/meinvtupian.html</li><li>çˆ¬å–ä¸Šè¿°é“¾æ¥ä¸­æ‰€æœ‰çš„å›¾ç‰‡æ•°æ®</li><li>å›¾ç‰‡æ‡’åŠ è½½ï¼š<ul><li>ä¸»è¦æ˜¯åº”ç”¨åœ¨å±•ç¤ºå›¾ç‰‡çš„ç½‘é¡µä¸­çš„ä¸€ç§æŠ€æœ¯ï¼Œè¯¥æŠ€æœ¯æ˜¯æŒ‡å½“ç½‘é¡µåˆ·æ–°åï¼Œå…ˆåŠ è½½å±€éƒ¨çš„å‡ å¼ å›¾ç‰‡æ•°æ®å³å¯ï¼Œéšç€ç”¨æˆ·æ»‘åŠ¨æ»šè½®ï¼Œå½“å›¾ç‰‡è¢«æ˜¾ç¤ºåœ¨æµè§ˆå™¨çš„å¯è§†åŒ–åŒºåŸŸèŒƒå›´çš„è¯ï¼Œåœ¨åŠ¨æ€å°†å…¶å›¾ç‰‡è¯·æ±‚åŠ è½½å‡ºæ¥å³å¯ã€‚ï¼ˆå›¾ç‰‡æ•°æ®æ˜¯åŠ¨æ€åŠ è½½å‡ºæ¥ï¼‰ã€‚</li><li>å¦‚ä½•å®ç°å›¾ç‰‡æ‡’åŠ è½½/åŠ¨æ€åŠ è½½ï¼Ÿ<ul><li>ä½¿ç”¨imgæ ‡ç­¾çš„ä¼ªå±æ€§ï¼ˆæŒ‡çš„æ˜¯è‡ªå®šä¹‰çš„ä¸€ç§å±æ€§ï¼‰ã€‚åœ¨ç½‘é¡µä¸­ï¼Œä¸ºäº†é˜²æ­¢å›¾ç‰‡é©¬ä¸ŠåŠ è½½å‡ºæ¥ï¼Œåˆ™åœ¨imgæ ‡ç­¾ä¸­å¯ä»¥ä½¿ç”¨ä¸€ç§ä¼ªå±æ€§æ¥å­˜å‚¨å›¾ç‰‡çš„é“¾æ¥ï¼Œè€Œä¸æ˜¯ä½¿ç”¨çœŸæ­£çš„srcå±æ€§å€¼æ¥å­˜å‚¨å›¾ç‰‡é“¾æ¥ã€‚ï¼ˆå›¾ç‰‡é“¾æ¥ä¸€æ—¦ç»™äº†srcå±æ€§ï¼Œåˆ™å›¾ç‰‡ä¼šè¢«ç«‹å³åŠ è½½å‡ºæ¥ï¼‰ã€‚åªæœ‰å½“å›¾ç‰‡è¢«æ»‘åŠ¨åˆ°æµè§ˆå™¨å¯è§†åŒ–åŒºåŸŸèŒƒå›´çš„æ—¶å€™ï¼Œåœ¨é€šè¿‡jså°†imgçš„ä¼ªå±æ€§ä¿®æ”¹ä¸ºçœŸæ­£çš„srcå±æ€§ï¼Œåˆ™å›¾ç‰‡å°±ä¼šè¢«åŠ è½½å‡ºæ¥ã€‚</li></ul></li></ul></li><li>å¦‚ä½•çˆ¬å–å›¾ç‰‡æ‡’åŠ è½½çš„å›¾ç‰‡æ•°æ®ï¼Ÿ<ul><li>åªéœ€è¦åœ¨è§£æå›¾ç‰‡çš„æ—¶å€™ï¼Œå®šä½ä¼ªå±æ€§ï¼ˆsrc2ï¼‰çš„å±æ€§å€¼å³å¯ã€‚</li></ul></li></ul></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div id=QR style=opacity:0><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=https://canw0916.github.io/img/wxPay.jpg alt=wechat_pay></a><p>å¾®ä¿¡</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=https://canw0916.github.io/img/aliPay.jpg alt=alipay></a><p>æ”¯ä»˜å®</p></div></div><button id=rewardButton onclick='var qr=document.getElementById("QR");qr.style.opacity==="0"?qr.style.opacity="1":qr.style.opacity="0"'>
<span>ğŸ§§ é¼“åŠ±</span></button></div></div><footer class=post-footer><nav class=paginav><a class=prev href=https://canw0916.github.io/en/posts/tech/%E5%BC%82%E6%AD%A5%E7%88%AC%E8%99%AB/><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>å¼‚æ­¥çˆ¬è™«</span>
</a><a class=next href=https://canw0916.github.io/en/posts/tech/%E7%88%AC%E8%99%AB%E6%95%B0%E6%8D%AE%E8%A7%A3%E6%9E%90/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>çˆ¬è™«æ•°æ®è§£æ</span></a></nav></footer></div><div><div class=pagination__title><span class=pagination__title-h style=font-size:20px>ğŸ’¬è¯„è®º</span><hr></div><div id=tcomment></div><script src=https://utteranc.es/client.js repo=canw0916/utterances_comments issue-term=title theme=photon-dark crossorigin=anonymous async></script></div></article></main><script async src=https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><footer class=footer><span>Copyright
&copy;
2023-2025
<a href=https://canw0916.github.io/en/ style=color:#939393>Felix's Blog</a>
All Rights Reserved
</span><a href=https://beian.miit.gov.cn/ target=_blank style=color:#939393></a>&nbsp;
<span><a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=null" style=display:inline-block;text-decoration:none;height:20px;color:#939393><img src style="float:left;margin:0 5px 0 0">
</a></span><span id=busuanzi_container><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css>æ€»è®¿å®¢æ•°: <span id=busuanzi_value_site_uv></span>
æ€»è®¿é—®é‡: <span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg class="topSvg" viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
<span id=read_progress></span>
</span></a><script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>let mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>400||document.documentElement.scrollTop>400?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="ğŸ“„å¤åˆ¶";function s(){t.innerText="ğŸ‘ŒğŸ»å·²å¤åˆ¶!",setTimeout(()=>{t.innerText="ğŸ“„å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){let t=e.textContent+`\r
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r
ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€ŒFelix's Blogã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚\r
åŸæ–‡é“¾æ¥ï¼š`+location.href;navigator.clipboard.writeText(t),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild===n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName==="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script src=https://code.jquery.com/jquery-1.12.4.min.js></script><script>$("code[class^=language] ").on("mouseover",function(){this.clientWidth<this.scrollWidth&&$(this).css("width","135%")}).on("mouseout",function(){$(this).css("width","100%")})</script></body></html>