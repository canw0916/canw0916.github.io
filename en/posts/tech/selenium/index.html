<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Selenium | Felix's Blog</title><meta name=keywords content><meta name=description content="ç®€ä»‹ selenium æ˜¯ä¸€ç§æµè§ˆå™¨è‡ªåŠ¨åŒ–çš„å·¥å…·ï¼Œæ‰€è°“çš„è‡ªåŠ¨åŒ–æ˜¯æŒ‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç çš„å½¢å¼åˆ¶å®šä¸€ç³»åˆ—çš„è¡Œä¸ºåŠ¨ä½œï¼Œç„¶åæ‰§è¡Œä»£ç ï¼Œè¿™äº›åŠ¨ä½œå°±ä¼šåŒæ­¥è§¦å‘åœ¨æµè§ˆå™¨ä¸­ã€‚"><meta name=author content="
ğŸ‘¦&nbsp;Felix"><link rel=canonical href=https://canw0916.github.io/en/posts/tech/selenium/><link crossorigin=anonymous href=/assets/css/stylesheet.b93dd213ece484c2198b1b6b8cb8d2248f9f93dda4c99f628a97f7e932ee21f8.css integrity="sha256-uT3SE+zkhMIZixtrjLjSJI+fk92kyZ9iipf36TLuIfg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://canw0916.github.io/img/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://canw0916.github.io/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://canw0916.github.io/img/favicon-32x32.png><link rel=apple-touch-icon href=https://canw0916.github.io/img/apple-touch-icon.png><link rel=mask-icon href=https://canw0916.github.io/img/android-chrome-512x512.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-7ENSZ7BS0C"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-7ENSZ7BS0C",{anonymize_ip:!1})}</script><meta property="og:title" content="Selenium"><meta property="og:description" content="ç®€ä»‹ selenium æ˜¯ä¸€ç§æµè§ˆå™¨è‡ªåŠ¨åŒ–çš„å·¥å…·ï¼Œæ‰€è°“çš„è‡ªåŠ¨åŒ–æ˜¯æŒ‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç çš„å½¢å¼åˆ¶å®šä¸€ç³»åˆ—çš„è¡Œä¸ºåŠ¨ä½œï¼Œç„¶åæ‰§è¡Œä»£ç ï¼Œè¿™äº›åŠ¨ä½œå°±ä¼šåŒæ­¥è§¦å‘åœ¨æµè§ˆå™¨ä¸­ã€‚"><meta property="og:type" content="article"><meta property="og:url" content="https://canw0916.github.io/en/posts/tech/selenium/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-10T14:20:32+08:00"><meta property="article:modified_time" content="2023-02-10T14:20:32+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Selenium"><meta name=twitter:description content="ç®€ä»‹ selenium æ˜¯ä¸€ç§æµè§ˆå™¨è‡ªåŠ¨åŒ–çš„å·¥å…·ï¼Œæ‰€è°“çš„è‡ªåŠ¨åŒ–æ˜¯æŒ‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç çš„å½¢å¼åˆ¶å®šä¸€ç³»åˆ—çš„è¡Œä¸ºåŠ¨ä½œï¼Œç„¶åæ‰§è¡Œä»£ç ï¼Œè¿™äº›åŠ¨ä½œå°±ä¼šåŒæ­¥è§¦å‘åœ¨æµè§ˆå™¨ä¸­ã€‚"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ğŸ“šæ–‡ç« ","item":"https://canw0916.github.io/en/posts/"},{"@type":"ListItem","position":2,"name":"ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯","item":"https://canw0916.github.io/en/posts/tech/"},{"@type":"ListItem","position":3,"name":"Selenium","item":"https://canw0916.github.io/en/posts/tech/selenium/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Selenium","name":"Selenium","description":"ç®€ä»‹ selenium æ˜¯ä¸€ç§æµè§ˆå™¨è‡ªåŠ¨åŒ–çš„å·¥å…·ï¼Œæ‰€è°“çš„è‡ªåŠ¨åŒ–æ˜¯æŒ‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç çš„å½¢å¼åˆ¶å®šä¸€ç³»åˆ—çš„è¡Œä¸ºåŠ¨ä½œï¼Œç„¶åæ‰§è¡Œä»£ç ï¼Œè¿™äº›åŠ¨ä½œå°±ä¼šåŒæ­¥è§¦å‘åœ¨æµè§ˆå™¨ä¸­ã€‚","keywords":[""],"articleBody":"ç®€ä»‹ selenium æ˜¯ä¸€ç§æµè§ˆå™¨è‡ªåŠ¨åŒ–çš„å·¥å…·ï¼Œæ‰€è°“çš„è‡ªåŠ¨åŒ–æ˜¯æŒ‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç çš„å½¢å¼åˆ¶å®šä¸€ç³»åˆ—çš„è¡Œä¸ºåŠ¨ä½œï¼Œç„¶åæ‰§è¡Œä»£ç ï¼Œè¿™äº›åŠ¨ä½œå°±ä¼šåŒæ­¥è§¦å‘åœ¨æµè§ˆå™¨ä¸­ã€‚ ç¯å¢ƒå®‰è£… ä¸‹è½½å®‰è£…seleniumï¼špip install selenium ä¸‹è½½æµè§ˆå™¨é©±åŠ¨ç¨‹åºï¼š http://chromedriver.storage.googleapis.com/index.html æŸ¥çœ‹é©±åŠ¨å’Œæµè§ˆå™¨ç‰ˆæœ¬çš„æ˜ å°„å…³ç³»ï¼š http://blog.csdn.net/huilan_same/article/details/51896672 æ•ˆæœå±•ç¤º from selenium import webdriver from time import sleep # åé¢æ˜¯ä½ çš„æµè§ˆå™¨é©±åŠ¨ä½ç½®ï¼Œè®°å¾—å‰é¢åŠ r'','r'æ˜¯é˜²æ­¢å­—ç¬¦è½¬ä¹‰çš„ driver = webdriver.Chrome(r'./chromedriver') # ç”¨getæ‰“å¼€ç™¾åº¦é¡µé¢ driver.get(\"http://www.baidu.com\") # æŸ¥æ‰¾é¡µé¢çš„â€œè®¾ç½®â€é€‰é¡¹ï¼Œå¹¶è¿›è¡Œç‚¹å‡» driver.find_element_by_xpath('//*[@id=\"s-usersetting-top\"]').click() sleep(2) # # æ‰“å¼€è®¾ç½®åæ‰¾åˆ°â€œæœç´¢è®¾ç½®â€é€‰é¡¹ï¼Œè®¾ç½®ä¸ºæ¯é¡µæ˜¾ç¤º50æ¡ driver.find_elements_by_link_text('æœç´¢è®¾ç½®')[0].click() sleep(2) # é€‰ä¸­æ¯é¡µæ˜¾ç¤º50æ¡ m = driver.find_element_by_xpath('//*[@id=\"nr_3\"]').click() sleep(2) # ç‚¹å‡»ä¿å­˜è®¾ç½® driver.find_element_by_xpath('//*[@id=\"se-setting-7\"]/a[2]').click() sleep(2) # å¤„ç†å¼¹å‡ºçš„è­¦å‘Šé¡µé¢ ç¡®å®šaccept() å’Œ å–æ¶ˆdismiss() driver.switch_to_alert().accept() sleep(2) # æ‰¾åˆ°ç™¾åº¦çš„è¾“å…¥æ¡†ï¼Œå¹¶è¾“å…¥ ç¾å¥³ driver.find_element_by_id('kw').send_keys('ç¾å¥³') sleep(2) # ç‚¹å‡»æœç´¢æŒ‰é’® driver.find_element_by_id('su').click() sleep(2) # åœ¨æ‰“å¼€çš„é¡µé¢ä¸­æ‰¾åˆ°â€œSelenium - å¼€æºä¸­å›½ç¤¾åŒºâ€ï¼Œå¹¶æ‰“å¼€è¿™ä¸ªé¡µé¢ driver.find_element_by_xpath('//*[@id=\"1\"]/div/h3/a').click() sleep(3) # å…³é—­æµè§ˆå™¨ driver.quit() æµè§ˆå™¨åˆ›å»º Seleniumæ”¯æŒéå¸¸å¤šçš„æµè§ˆå™¨ï¼Œå¦‚Chromeã€Firefoxã€Edgeç­‰.å¦å¤–ï¼Œä¹Ÿæ”¯æŒæ— ç•Œé¢æµè§ˆå™¨ã€‚\nfrom selenium import webdriver browser = webdriver.Chrome() browser = webdriver.Firefox() browser = webdriver.Edge() browser = webdriver.PhantomJS() browser = webdriver.Safari() å…ƒç´ å®šä½ webdriver æä¾›äº†ä¸€ç³»åˆ—çš„å…ƒç´ å®šä½æ–¹æ³•ï¼Œå¸¸ç”¨çš„æœ‰ä»¥ä¸‹å‡ ç§ï¼š\nfind_element_by_id() find_element_by_name() find_element_by_class_name() find_element_by_tag_name() find_element_by_link_text() find_element_by_xpath() find_element_by_css_selector() èŠ‚ç‚¹äº¤äº’ Seleniumå¯ä»¥é©±åŠ¨æµè§ˆå™¨æ¥æ‰§è¡Œä¸€äº›æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥è®©æµè§ˆå™¨æ¨¡æ‹Ÿæ‰§è¡Œä¸€äº›åŠ¨ä½œã€‚æ¯”è¾ƒå¸¸è§çš„ç”¨æ³•æœ‰ï¼šè¾“å…¥æ–‡å­—æ—¶ç”¨send_keys()æ–¹æ³•ï¼Œæ¸…ç©ºæ–‡å­—æ—¶ç”¨clear()æ–¹æ³•ï¼Œç‚¹å‡»æŒ‰é’®æ—¶ç”¨click()æ–¹æ³•ã€‚ æ‰§è¡Œjs å¯¹äºæŸäº›æ“ä½œï¼ŒSelenium APIå¹¶æ²¡æœ‰æä¾›ã€‚æ¯”å¦‚ï¼Œä¸‹æ‹‰è¿›åº¦æ¡ï¼Œå®ƒå¯ä»¥ç›´æ¥æ¨¡æ‹Ÿè¿è¡ŒJavaScriptï¼Œæ­¤æ—¶ä½¿ç”¨execute_script()æ–¹æ³•å³å¯å®ç°ã€‚\nfrom selenium import webdriver from time import sleep #1.åˆ›å»ºä¸€ä¸ªæµè§ˆå™¨å¯¹è±¡,executable_pathæŒ‡å®šå½“å‰æµè§ˆå™¨çš„é©±åŠ¨ç¨‹åº #æ³¨æ„ï¼šæˆ‘å½“å‰æ˜¯macç³»ç»Ÿï¼Œé©±åŠ¨ç¨‹åºä¹Ÿæ˜¯macç‰ˆæœ¬çš„ï¼Œå¦‚æœæ˜¯windowç³»ç»Ÿæ³¨æ„æ›´æ¢é©±åŠ¨ bro = webdriver.Chrome(executable_path='./chromedriver') #2.æµè§ˆå™¨çš„è¯·æ±‚å‘é€ bro.get('https://www.jd.com/') #3.æ ‡ç­¾å®šä½:è°ƒç”¨findç³»åˆ—çš„å‡½æ•°è¿›è¡Œæ ‡ç­¾å®šä½ search_box = bro.find_element_by_xpath('//*[@id=\"key\"]') #4.èŠ‚ç‚¹äº¤äº’ search_box.send_keys('mac pro m1')#å‘æŒ‡å®šæ ‡ç­¾ä¸­å½•å…¥å†…å®¹ sleep(2) btn = bro.find_element_by_xpath('//*[@id=\"search\"]/div/div[2]/button') btn.click() #ç‚¹å‡»æŒ‰é’® sleep(2) #jsæ³¨å…¥ bro.execute_script('document.documentElement.scrollTo(0,2000)') sleep(5) #å…³é—­æµè§ˆå™¨ bro.quit() æ€è€ƒï¼šåœ¨çˆ¬è™«ä¸­ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨seleniumï¼Ÿseleniumå’Œçˆ¬è™«ä¹‹é—´çš„å…³è”æ˜¯ä»€ä¹ˆï¼Ÿ\nä¾¿æ·çš„çˆ¬å–åŠ¨æ€åŠ è½½æ•°æ®ï¼ˆå¯è§å³å¯å¾—ï¼‰\n#è·å–å‰5é¡µçš„ä¼ä¸šåç§° from selenium import webdriver import time from lxml import etree bro = webdriver.Chrome(executable_path='./chromedriver') url = 'http://scxk.nmpa.gov.cn:81/xk/' bro.get(url=url) time.sleep(1) #è·å–é¡µé¢æºç æ•°æ®(page_source) page_text = bro.page_source #å°†å‰5é¡µçš„é¡µé¢æºç æ•°æ®å­˜å‚¨åˆ°è¯¥åˆ—è¡¨ä¸­ all_page_text_list = [page_text] for i in range(4): #ç‚¹å‡»ä¸‹ä¸€é¡µ next_page_btn = bro.find_element_by_xpath('//*[@id=\"pageIto_next\"]') next_page_btn.click() time.sleep(1) all_page_text_list.append(bro.page_source) for page_text in all_page_text_list: #è§£ææ•°æ® tree = etree.HTML(page_text) li_list = tree.xpath('//*[@id=\"gzlist\"]/li') for li in li_list: title = li.xpath('./dl/@title')[0] print(title) time.sleep(2) bro.quit() ä¾¿æ·å®ç°æ¨¡æ‹Ÿç™»å½•\nåé¢åœ¨è¯´ è·å–é¡µé¢æºç æ•°æ® é€šè¿‡page_sourceå±æ€§å¯ä»¥è·å–ç½‘é¡µçš„æºä»£ç ï¼Œæ¥ç€å°±å¯ä»¥ä½¿ç”¨è§£æåº“ï¼ˆå¦‚æ­£åˆ™è¡¨è¾¾å¼ã€Beautiful Soupã€pyqueryç­‰ï¼‰æ¥æå–ä¿¡æ¯äº†ã€‚\nå‰è¿›å’Œåé€€ #æ¨¡æ‹Ÿæµè§ˆå™¨çš„å‰è¿›åé€€ from selenium import webdriver import time browser = webdriver.Chrome(r'./chromedriver') browser.get('https://www.baidu.com') browser.get('https://www.taobao.com') browser.back() time.sleep(2) browser.forward() time.sleep(2) browser.close() è·å–åŠ¨æ€åŠ è½½æ•°æ® å®ç°å¯è§å³å¯å¾— åŠ¨ä½œé“¾ åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œä¸€äº›äº¤äº’åŠ¨ä½œéƒ½æ˜¯é’ˆå¯¹æŸä¸ªèŠ‚ç‚¹æ‰§è¡Œçš„ã€‚æ¯”å¦‚ï¼Œå¯¹äºè¾“å…¥æ¡†ï¼Œæˆ‘ä»¬å°±è°ƒç”¨å®ƒçš„è¾“å…¥æ–‡å­—å’Œæ¸…ç©ºæ–‡å­—æ–¹æ³•ï¼›å¯¹äºæŒ‰é’®ï¼Œå°±è°ƒç”¨å®ƒçš„ç‚¹å‡»æ–¹æ³•ã€‚å…¶å®ï¼Œè¿˜æœ‰å¦å¤–ä¸€äº›æ“ä½œï¼Œå®ƒä»¬æ²¡æœ‰ç‰¹å®šçš„æ‰§è¡Œå¯¹è±¡ï¼Œæ¯”å¦‚é¼ æ ‡æ‹–æ›³ã€é”®ç›˜æŒ‰é”®ç­‰ï¼Œè¿™äº›åŠ¨ä½œç”¨å¦ä¸€ç§æ–¹å¼æ¥æ‰§è¡Œï¼Œé‚£å°±æ˜¯åŠ¨ä½œé“¾ã€‚\nfrom selenium.webdriver import ActionChains from selenium import webdriver from time import sleep bro = webdriver.Chrome(executable_path='./chromedriver') bro.get('https://www.runoob.com/try/try.php?filename=jqueryui-api-droppable') sleep(1) #æ³¨æ„ï¼šå¦‚æœå®šä½çš„æ ‡ç­¾æ˜¯å­˜åœ¨äºiframeè¡¨ç¤ºçš„å­é¡µé¢ä¸­ï¼Œåˆ™å¸¸è§„çš„æ ‡ç­¾å®šä½æŠ¥é”™ #å¤„ç†ï¼šä½¿ç”¨å¦‚ä¸‹æŒ‡å®šæ“ä½œ bro.switch_to.frame('iframeResult') div_tag = bro.find_element_by_id('draggable') #å®ä¾‹åŒ–ä¸€ä¸ªåŠ¨ä½œé“¾å¯¹è±¡ä¸”å°†è¯¥å¯¹è±¡ç»‘å®šåˆ°æŒ‡å®šçš„æµè§ˆå™¨ä¸­ action = ActionChains(bro) action.click_and_hold(div_tag) #å¯¹æŒ‡å®šæ ‡ç­¾å®ç°ç‚¹å‡»ä¸”é•¿æŒ‰æ“ä½œ for i in range(5): action.move_by_offset(10,10).perform() #performè®©åŠ¨ä½œé“¾ç«‹å³æ‰§è¡Œ sleep(0.5) sleep(3) bro.quit() å¸¦éªŒè¯ç çš„æ¨¡æ‹Ÿç™»å½• ç™»å½•bilibili\nhttps://passport.bilibili.com/login?from_spm_id=333.851.top_bar.login_window è¯†åˆ«éªŒè¯ç æ¨¡å—å°è£…ï¼š\nimport base64 import json import requests # ä¸€ã€å›¾ç‰‡æ–‡å­—ç±»å‹(é»˜è®¤ 3 æ•°è‹±æ··åˆ)ï¼š # 1 : çº¯æ•°å­— # 1001ï¼šçº¯æ•°å­—2 # 2 : çº¯è‹±æ–‡ # 1002ï¼šçº¯è‹±æ–‡2 # 3 : æ•°è‹±æ··åˆ # 1003ï¼šæ•°è‹±æ··åˆ2 # 4 : é—ªåŠ¨GIF # 7 : æ— æ„Ÿå­¦ä¹ (ç‹¬å®¶) # 11 : è®¡ç®—é¢˜ # 1005: å¿«é€Ÿè®¡ç®—é¢˜ # 16 : æ±‰å­— # 32 : é€šç”¨æ–‡å­—è¯†åˆ«(è¯ä»¶ã€å•æ®) # 66: é—®ç­”é¢˜ # 49 :recaptchaå›¾ç‰‡è¯†åˆ« # äºŒã€å›¾ç‰‡æ—‹è½¬è§’åº¦ç±»å‹ï¼š # 29 : æ—‹è½¬ç±»å‹ # # ä¸‰ã€å›¾ç‰‡åæ ‡ç‚¹é€‰ç±»å‹ï¼š # 19 : 1ä¸ªåæ ‡ # 20 : 3ä¸ªåæ ‡ # 21 : 3 ~ 5ä¸ªåæ ‡ # 22 : 5 ~ 8ä¸ªåæ ‡ # 27 : 1 ~ 4ä¸ªåæ ‡ # 48 : è½¨è¿¹ç±»å‹ # # å››ã€ç¼ºå£è¯†åˆ« # 18 : ç¼ºå£è¯†åˆ«ï¼ˆéœ€è¦2å¼ å›¾ ä¸€å¼ ç›®æ ‡å›¾ä¸€å¼ ç¼ºå£å›¾ï¼‰ # 33 : å•ç¼ºå£è¯†åˆ«ï¼ˆè¿”å›Xè½´åæ ‡ åªéœ€è¦1å¼ å›¾ï¼‰ # äº”ã€æ‹¼å›¾è¯†åˆ« # 53ï¼šæ‹¼å›¾è¯†åˆ« #å‡½æ•°å®ç°å¿½ç•¥ def base64_api(uname, pwd, img, typeid): with open(img, 'rb') as f: base64_data = base64.b64encode(f.read()) b64 = base64_data.decode() data = {\"username\": uname, \"password\": pwd, \"typeid\": typeid, \"image\": b64} result = json.loads(requests.post(\"http://api.ttshitu.com/predict\", json=data).text) if result['success']: return result[\"data\"][\"result\"] else: return result[\"message\"] return \"\" def getImgCodeText(imgPath,imgType):#ç›´æ¥è¿”å›éªŒè¯ç å†…å®¹ #imgPathï¼šéªŒè¯ç å›¾ç‰‡åœ°å€ #imgTypeï¼šéªŒè¯ç å›¾ç‰‡ç±»å‹ result = base64_api(uname='å›¾é‰´çš„è´¦å·', pwd='å›¾é‰´çš„å¯†ç ', img=imgPath, typeid=imgType) return result from selenium import webdriver from selenium.webdriver import ActionChains from time import sleep import tujian #1.åˆ›å»ºæµè§ˆå™¨å¯¹è±¡ bro = webdriver.Chrome(executable_path='./chromedriver') #2.å‘èµ·è¯·æ±‚ login_url = 'https://passport.bilibili.com/login?from_spm_id=333.851.top_bar.login_window' bro.get(login_url) sleep(1) #3.å®šä½åˆ°æŒ‡å®šæ ‡ç­¾å¡«å……ç”¨æˆ·åå’Œå¯†ç  user_box = bro.find_element_by_xpath('//*[@id=\"login-username\"]') user_box.send_keys('15027900535') sleep(1) pwd_box = bro.find_element_by_xpath('//*[@id=\"login-passwd\"]') pwd_box.send_keys('1234567890') sleep(1) login_btn = bro.find_element_by_xpath('//*[@id=\"geetest-wrap\"]/div/div[5]/a[1]') login_btn.click() sleep(1) #4.å®šä½å®Œæ•´çš„éªŒè¯ç å¯¹è¯æ¡† #æ³¨æ„ï¼šåœ¨å¼€å‘è€…å·¥å…·ä¸­æ˜¯å¯ä»¥å®šä½åˆ°å¤šä¸ªdivè¡¨ç¤ºéªŒè¯ç å¯¹è¯æ¡†çš„ï¼Œå› æ­¤å°†è¿™å‡ ä¸ªdivéƒ½å®šä½åˆ°ï¼Œä»¥æ­¤å»å°è¯• code_tag = bro.find_element_by_xpath('/html/body/div[2]/div[2]/div[6]/div/div') sleep(1) #5.è¯†åˆ«éªŒè¯ç ï¼ˆä½¿ç”¨æ‰“ç å¹³å°è¿›è¡ŒéªŒè¯ç è¯†åˆ«ï¼‰ code_tag.screenshot('./code.png')#å°†éªŒè¯ç å¯¹è¯æ¡†æˆªå›¾ä¿å­˜ sleep(1) #ä½¿ç”¨å›¾é‰´æ¥å£è¯†åˆ« result = tujian.getImgCodeText('./code.png',27)#è·å–äº†è¯†åˆ«çš„ç»“æœ # result = '154,251|145,167' # print(result) result_list = result.split('|') #result_list == ['154,251','145,167'] #6.æ ¹æ®è¯†åˆ«å‡ºéªŒè¯ç çš„ç»“æœè¿›è¡Œå¤„ç† for pos in result_list: x = int(pos.split(',')[0]) y = int(pos.split(',')[1]) ActionChains(bro).move_to_element_with_offset(code_tag,x,y).click().perform() sleep(0.5) confirm_btn = bro.find_element_by_xpath('/html/body/div[2]/div[2]/div[6]/div/div/div[3]/a/div') confirm_btn.click() sleep(3) bro.quit()1 Cookie ä½¿ç”¨Seleniumï¼Œè¿˜å¯ä»¥æ–¹ä¾¿åœ°å¯¹Cookiesè¿›è¡Œæ“ä½œï¼Œä¾‹å¦‚å¸¸è§çš„è·å–Cookiesï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š\nget_cookies()è¿”å›å€¼æ˜¯ç”±å­—å…¸ç»„æˆçš„åˆ—è¡¨ï¼Œå«åšjsonCookiesã€‚ éœ€è¦å°†jsonCookiesè§£ææˆæµè§ˆå™¨æºå¸¦çš„cookieå½¢å¼ #è·å–jsonCookies from selenium import webdriver import time browser = webdriver.Chrome(r'./chromedriver') browser.get('https://www.zhihu.com/explore') print(browser.get_cookies()) browser.close() è§£æjsonCookiesæˆæµè§ˆå™¨çš„cookieå½¢å¼\nfrom selenium import webdriver import time browser = webdriver.Chrome(r'./chromedriver') browser.get('https://www.zhihu.com/explore') #è·å–cookie cookies = browser.get_cookies() #è§£æcookie dic = {} for cookie in cookies: key = cookie['name'] value = cookie['value'] dic[key] = value print(dic) #åœ¨çˆ¬è™«ä¸­å¯ä»¥ä½¿ç”¨çš„cookie browser.close() åŸºäºseleniumè·å–cookieåï¼Œç»•è¿‡æ¨¡æ‹Ÿç™»å½•\nfrom selenium.webdriver import Chrome import time import json web = Chrome('./chromedriver') web.get('https://www.17k.com/') time.sleep(3) # ç™»å½• web.find_element_by_xpath('//*[@id=\"header_login_user\"]/a[1]').click() # åˆ‡æ¢iframe iframe = web.find_element_by_xpath('/html/body/div[20]/div/div[1]/iframe') web.switch_to.frame(iframe) web.find_element_by_xpath('/html/body/form/dl/dd[2]/input').send_keys(\"15027900535\") web.find_element_by_xpath('/html/body/form/dl/dd[3]/input').send_keys(\"bobo328410948\") web.find_element_by_xpath('/html/body/form/dl/dd[5]/input').click() time.sleep(3) cookies = web.get_cookies() # å­˜æ–‡ä»¶é‡Œ with open(\"cookies.txt\", mode=\"w\", encoding='utf-8') as f: f.write(json.dumps(cookies)) # ç»„è£…cookieå­—å…¸, ç›´æ¥ç»™requestsç”¨ dic = {} for cook in cookies: dic[cook['name']] = cook['value'] # è¡”æ¥. æŠŠcookieç›´æ¥æ€¼è¿›å» import requests #è®¿é—®çš„ä¹¦æ¶ï¼ˆè·å–ä¹¦æ¶å†…å®¹ï¼‰ url = \"https://user.17k.com/ck/author/shelf?page=1\u0026appKey=2406394919\" headers = { 'cookie':dic } resp = requests.get(url,cookies=dic) print(resp.text) web.close() æ— å¤´æµè§ˆå™¨ æ— å¤´æµè§ˆå™¨å°±æ˜¯æ²¡æœ‰å¯è§†åŒ–ç•Œé¢çš„æµè§ˆå™¨\nfrom selenium import webdriver from selenium.webdriver.chrome.options import Options import time # åˆ›å»ºä¸€ä¸ªå‚æ•°å¯¹è±¡ï¼Œç”¨æ¥æ§åˆ¶chromeä»¥æ— ç•Œé¢æ¨¡å¼æ‰“å¼€ chrome_options = Options() chrome_options.add_argument('--headless') chrome_options.add_argument('--disable-gpu') # é©±åŠ¨è·¯å¾„ path = './chromedriver' # åˆ›å»ºæµè§ˆå™¨å¯¹è±¡ browser = webdriver.Chrome(executable_path=path,options=chrome_options) # ä¸Šç½‘ url = 'http://www.baidu.com/' browser.get(url) time.sleep(3) browser.save_screenshot('baidu.png') browser.quit() è§„é¿æ£€æµ‹ï¼ˆé‡è¦ï¼‰ ç°åœ¨ä¸å°‘å¤§ç½‘ç«™æœ‰å¯¹seleniumé‡‡å–äº†ç›‘æµ‹æœºåˆ¶ã€‚æ¯”å¦‚æ­£å¸¸æƒ…å†µä¸‹æˆ‘ä»¬ç”¨æµè§ˆå™¨è®¿é—®æ·˜å®ç­‰ç½‘ç«™çš„ window.navigator.webdriverçš„å€¼ä¸º undefinedæˆ–è€…ä¸ºfalseã€‚è€Œä½¿ç”¨seleniumè®¿é—®åˆ™è¯¥å€¼ä¸ºtrueã€‚é‚£ä¹ˆå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ\nå®ç°jsæ³¨å…¥ï¼Œç»•è¿‡æ£€æµ‹ from selenium.webdriver import ActionChains from selenium.webdriver import Chrome from selenium.webdriver.chrome.options import Options chrome_options = Options() chrome_options.add_argument(\"--disable-blink-features=AutomationControlled\") chrome_options.add_argument('user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36') driver = Chrome('./chromedriver',options=chrome_options) #Seleniumåœ¨æ‰“å¼€ä»»ä½•é¡µé¢ä¹‹å‰ï¼Œå…ˆè¿è¡Œè¿™ä¸ªJsæ–‡ä»¶ã€‚ with open('./stealth.min.js') as f: js = f.read() #è¿›è¡Œjsæ³¨å…¥ï¼Œç»•è¿‡æ£€æµ‹ #execute_cdp_cmdæ‰§è¡Œcdpå‘½ä»¤ï¼ˆåœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­æ‰§è¡Œç›¸å…³æŒ‡ä»¤ï¼Œå®Œæˆç›¸å…³æ“ä½œï¼‰ #Page.addScriptToEvaluateOnNewDocumentæ‰§è¡Œè„šæœ¬ driver.execute_cdp_cmd(\"Page.addScriptToEvaluateOnNewDocument\", { \"source\": js }) driver.get('https://www.taobao.com') 12306å†æ¬¡æµ‹è¯•\næ²¡æœ‰å®ç°è§„é¿æ£€æµ‹ä»£ç æ—¶çš„ç™»å½•ï¼š\nfrom selenium.webdriver import Chrome from selenium.webdriver import ActionChains from time import sleep web = Chrome(executable_path='./chromedriver') web.get(\"https://kyfw.12306.cn/otn/resources/login.html\") sleep(2) web.find_element_by_xpath('//*[@id=\"toolbar_Div\"]/div[2]/div[2]/ul/li[1]/a').click() web.find_element_by_xpath('//*[@id=\"J-userName\"]').send_keys(\"hehehe@126.com\") sleep(1) web.find_element_by_xpath('//*[@id=\"J-password\"]').send_keys(\"111111\") sleep(1) web.find_element_by_xpath('//*[@id=\"J-login\"]').click() sleep(3) action = ActionChains(web) # æ‰¾åˆ°æ»‘å— btn = web.find_element_by_xpath('//*[@id=\"nc_1_n1z\"]') action.click_and_hold(btn) for i in range(5): action.move_by_offset(50,0).perform() sleep(0.5) sleep(3) web.close() å®ç°è§„é¿æ£€æµ‹åï¼š\nfrom selenium.webdriver import Chrome from selenium.webdriver import ActionChains from time import sleep from selenium.webdriver.chrome.options import Options chrome_options = Options() chrome_options.add_argument(\"--disable-blink-features=AutomationControlled\") chrome_options.add_argument('user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36') web = Chrome(executable_path='./chromedriver',options=chrome_options) #Seleniumåœ¨æ‰“å¼€ä»»ä½•é¡µé¢ä¹‹å‰ï¼Œå…ˆè¿è¡Œè¿™ä¸ªJsæ–‡ä»¶ã€‚ with open('./stealth.min.js') as f: js = f.read() #è¿›è¡Œjsæ³¨å…¥ï¼Œç»•è¿‡æ£€æµ‹ web.execute_cdp_cmd(\"Page.addScriptToEvaluateOnNewDocument\", { \"source\": js }) web.get(\"https://kyfw.12306.cn/otn/resources/login.html\") sleep(2) web.find_element_by_xpath('//*[@id=\"toolbar_Div\"]/div[2]/div[2]/ul/li[1]/a').click() web.find_element_by_xpath('//*[@id=\"J-userName\"]').send_keys(\"hehehe@126.com\") sleep(1) web.find_element_by_xpath('//*[@id=\"J-password\"]').send_keys(\"111111\") sleep(1) web.find_element_by_xpath('//*[@id=\"J-login\"]').click() sleep(3) action = ActionChains(web) # æ‰¾åˆ°æ»‘å— btn = web.find_element_by_xpath('//*[@id=\"nc_1_n1z\"]') action.click_and_hold(btn) for i in range(5): action.move_by_offset(50,0).perform() sleep(0.5) sleep(3) web.close() ","wordCount":"3418","inLanguage":"en","datePublished":"2023-02-10T14:20:32+08:00","dateModified":"2023-02-10T14:20:32+08:00","author":[{"@type":"Person","name":"Felix"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://canw0916.github.io/en/posts/tech/selenium/"},"publisher":{"@type":"Organization","name":"Felix's Blog","logo":{"@type":"ImageObject","url":"https://canw0916.github.io/img/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><script async src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script><header class=header><nav class=nav><div class=logo><a href=https://canw0916.github.io/en/ accesskey=h title="Felix's Blog (Alt + H)"><img src=https://canw0916.github.io/img/android-chrome-512x512.png alt=logo aria-label=logo height=35>Felix's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://canw0916.github.io/en/search title="ğŸ” æœç´¢ (Alt + /)" accesskey=/><span>ğŸ” æœç´¢</span></a></li><li><a href=https://canw0916.github.io/en/ title="ğŸ  ä¸»é¡µ"><span>ğŸ  ä¸»é¡µ</span></a></li><li><a href=https://canw0916.github.io/en/posts title="ğŸ“š æ–‡ç« "><span>ğŸ“š æ–‡ç« </span></a></li><li><a href=https://canw0916.github.io/en/tags title="ğŸ§© æ ‡ç­¾"><span>ğŸ§© æ ‡ç­¾</span></a></li><li><a href=https://canw0916.github.io/en/archives/ title="â±ï¸ æ—¶é—´è½´"><span>â±ï¸ æ—¶é—´è½´</span></a></li><li><a href=https://canw0916.github.io/en/about title="ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº"><span>ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº</span></a></li><li><a href=https://canw0916.github.io/en/links title="ğŸ¤ å‹é“¾"><span>ğŸ¤ å‹é“¾</span></a></li></ul></nav></header><main class="main page"><article class=post-single><div id=single-content><header class=post-header><div class=breadcrumbs><a href=https://canw0916.github.io/en/>ğŸ ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href=https://canw0916.github.io/en/posts/>ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href=https://canw0916.github.io/en/posts/tech/>ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯</a></div><h1 class=post-title>Selenium</h1><div class=post-meta>ğŸ“…&nbsp;<span title='2023-02-10 14:20:32 +0800 +0800'>2023-02-10</span>&nbsp;&nbsp;ğŸ“„&nbsp;3418å­—&nbsp;&nbsp;â³&nbsp;7åˆ†é’Ÿ&nbsp;&nbsp;
ğŸ‘¦&nbsp;Felix
&nbsp;&nbsp;ğŸ·ï¸ &nbsp;<ul class=post-tags-meta><a href=https://canw0916.github.io/en/tags/python/>python</a></ul><span id=busuanzi_container_page_pv>&nbsp; ğŸ¯ <span id=busuanzi_value_page_pv></span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>æ–‡ç« ç›®å½•</span></summary><div class=inner><ul><li><a href=#%e7%ae%80%e4%bb%8b aria-label=ç®€ä»‹>ç®€ä»‹</a></li><li><a href=#%e7%8e%af%e5%a2%83%e5%ae%89%e8%a3%85 aria-label=ç¯å¢ƒå®‰è£…>ç¯å¢ƒå®‰è£…</a></li><li><a href=#%e6%95%88%e6%9e%9c%e5%b1%95%e7%a4%ba aria-label=æ•ˆæœå±•ç¤º>æ•ˆæœå±•ç¤º</a></li><li><a href=#%e6%b5%8f%e8%a7%88%e5%99%a8%e5%88%9b%e5%bb%ba aria-label=æµè§ˆå™¨åˆ›å»º><strong>æµè§ˆå™¨åˆ›å»º</strong></a></li><li><a href=#%e5%85%83%e7%b4%a0%e5%ae%9a%e4%bd%8d aria-label=å…ƒç´ å®šä½><strong>å…ƒç´ å®šä½</strong></a></li><li><a href=#%e8%8a%82%e7%82%b9%e4%ba%a4%e4%ba%92 aria-label=èŠ‚ç‚¹äº¤äº’>èŠ‚ç‚¹äº¤äº’</a></li><li><a href=#%e6%89%a7%e8%a1%8cjs aria-label=æ‰§è¡Œjs>æ‰§è¡Œjs</a></li><li><a href=#%e8%8e%b7%e5%8f%96%e9%a1%b5%e9%9d%a2%e6%ba%90%e7%a0%81%e6%95%b0%e6%8d%ae aria-label=è·å–é¡µé¢æºç æ•°æ®>è·å–é¡µé¢æºç æ•°æ®</a></li><li><a href=#%e5%89%8d%e8%bf%9b%e5%92%8c%e5%90%8e%e9%80%80 aria-label=å‰è¿›å’Œåé€€>å‰è¿›å’Œåé€€</a></li><li><a href=#%e8%8e%b7%e5%8f%96%e5%8a%a8%e6%80%81%e5%8a%a0%e8%bd%bd%e6%95%b0%e6%8d%ae aria-label=è·å–åŠ¨æ€åŠ è½½æ•°æ®>è·å–åŠ¨æ€åŠ è½½æ•°æ®</a></li><li><a href=#%e5%8a%a8%e4%bd%9c%e9%93%be aria-label=åŠ¨ä½œé“¾>åŠ¨ä½œé“¾</a></li><li><a href=#%e5%b8%a6%e9%aa%8c%e8%af%81%e7%a0%81%e7%9a%84%e6%a8%a1%e6%8b%9f%e7%99%bb%e5%bd%95 aria-label=å¸¦éªŒè¯ç çš„æ¨¡æ‹Ÿç™»å½•>å¸¦éªŒè¯ç çš„æ¨¡æ‹Ÿç™»å½•</a></li><li><a href=#cookie aria-label=Cookie>Cookie</a></li><li><a href=#%e6%97%a0%e5%a4%b4%e6%b5%8f%e8%a7%88%e5%99%a8 aria-label=æ— å¤´æµè§ˆå™¨>æ— å¤´æµè§ˆå™¨</a></li><li><a href=#%e8%a7%84%e9%81%bf%e6%a3%80%e6%b5%8b%e9%87%8d%e8%a6%81 aria-label=è§„é¿æ£€æµ‹ï¼ˆé‡è¦ï¼‰>è§„é¿æ£€æµ‹ï¼ˆé‡è¦ï¼‰</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h3 id=ç®€ä»‹>ç®€ä»‹<a hidden class=anchor aria-hidden=true href=#ç®€ä»‹>#</a></h3><ul><li>selenium<ul><li>æ˜¯ä¸€ç§æµè§ˆå™¨è‡ªåŠ¨åŒ–çš„å·¥å…·ï¼Œæ‰€è°“çš„è‡ªåŠ¨åŒ–æ˜¯æŒ‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç çš„å½¢å¼åˆ¶å®šä¸€ç³»åˆ—çš„è¡Œä¸ºåŠ¨ä½œï¼Œç„¶åæ‰§è¡Œä»£ç ï¼Œè¿™äº›åŠ¨ä½œå°±ä¼šåŒæ­¥è§¦å‘åœ¨æµè§ˆå™¨ä¸­ã€‚</li></ul></li></ul><h3 id=ç¯å¢ƒå®‰è£…>ç¯å¢ƒå®‰è£…<a hidden class=anchor aria-hidden=true href=#ç¯å¢ƒå®‰è£…>#</a></h3><ul><li>ä¸‹è½½å®‰è£…seleniumï¼špip install selenium</li><li>ä¸‹è½½æµè§ˆå™¨é©±åŠ¨ç¨‹åºï¼š<ul><li><a href=http://chromedriver.storage.googleapis.com/index.html>http://chromedriver.storage.googleapis.com/index.html</a></li></ul></li><li>æŸ¥çœ‹é©±åŠ¨å’Œæµè§ˆå™¨ç‰ˆæœ¬çš„æ˜ å°„å…³ç³»ï¼š<ul><li><a href=http://blog.csdn.net/huilan_same/article/details/51896672>http://blog.csdn.net/huilan_same/article/details/51896672</a></li></ul></li></ul><h3 id=æ•ˆæœå±•ç¤º>æ•ˆæœå±•ç¤º<a hidden class=anchor aria-hidden=true href=#æ•ˆæœå±•ç¤º>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>time</span> <span class=kn>import</span> <span class=n>sleep</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åé¢æ˜¯ä½ çš„æµè§ˆå™¨é©±åŠ¨ä½ç½®ï¼Œè®°å¾—å‰é¢åŠ r&#39;&#39;,&#39;r&#39;æ˜¯é˜²æ­¢å­—ç¬¦è½¬ä¹‰çš„</span>
</span></span><span class=line><span class=cl><span class=n>driver</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;./chromedriver&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># ç”¨getæ‰“å¼€ç™¾åº¦é¡µé¢</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;http://www.baidu.com&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># æŸ¥æ‰¾é¡µé¢çš„â€œè®¾ç½®â€é€‰é¡¹ï¼Œå¹¶è¿›è¡Œç‚¹å‡»</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;s-usersetting-top&#34;]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># # æ‰“å¼€è®¾ç½®åæ‰¾åˆ°â€œæœç´¢è®¾ç½®â€é€‰é¡¹ï¼Œè®¾ç½®ä¸ºæ¯é¡µæ˜¾ç¤º50æ¡</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>find_elements_by_link_text</span><span class=p>(</span><span class=s1>&#39;æœç´¢è®¾ç½®&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é€‰ä¸­æ¯é¡µæ˜¾ç¤º50æ¡</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>driver</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;nr_3&#34;]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç‚¹å‡»ä¿å­˜è®¾ç½®</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;se-setting-7&#34;]/a[2]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¤„ç†å¼¹å‡ºçš„è­¦å‘Šé¡µé¢   ç¡®å®šaccept() å’Œ å–æ¶ˆdismiss()</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>switch_to_alert</span><span class=p>()</span><span class=o>.</span><span class=n>accept</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># æ‰¾åˆ°ç™¾åº¦çš„è¾“å…¥æ¡†ï¼Œå¹¶è¾“å…¥ ç¾å¥³</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>find_element_by_id</span><span class=p>(</span><span class=s1>&#39;kw&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=s1>&#39;ç¾å¥³&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># ç‚¹å‡»æœç´¢æŒ‰é’®</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>find_element_by_id</span><span class=p>(</span><span class=s1>&#39;su&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># åœ¨æ‰“å¼€çš„é¡µé¢ä¸­æ‰¾åˆ°â€œSelenium - å¼€æºä¸­å›½ç¤¾åŒºâ€ï¼Œå¹¶æ‰“å¼€è¿™ä¸ªé¡µé¢</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;1&#34;]/div/h3/a&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å…³é—­æµè§ˆå™¨</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=æµè§ˆå™¨åˆ›å»º><strong>æµè§ˆå™¨åˆ›å»º</strong><a hidden class=anchor aria-hidden=true href=#æµè§ˆå™¨åˆ›å»º>#</a></h3><ul><li><p>Seleniumæ”¯æŒéå¸¸å¤šçš„æµè§ˆå™¨ï¼Œå¦‚Chromeã€Firefoxã€Edgeç­‰.å¦å¤–ï¼Œä¹Ÿæ”¯æŒæ— ç•Œé¢æµè§ˆå™¨ã€‚</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Firefox</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Edge</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>PhantomJS</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Safari</span><span class=p>()</span>
</span></span></code></pre></div></li></ul><h3 id=å…ƒç´ å®šä½><strong>å…ƒç´ å®šä½</strong><a hidden class=anchor aria-hidden=true href=#å…ƒç´ å®šä½>#</a></h3><ul><li><p>webdriver æä¾›äº†ä¸€ç³»åˆ—çš„å…ƒç´ å®šä½æ–¹æ³•ï¼Œå¸¸ç”¨çš„æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=n>find_element_by_id</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>find_element_by_name</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>find_element_by_class_name</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>find_element_by_tag_name</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>find_element_by_link_text</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>find_element_by_xpath</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>find_element_by_css_selector</span><span class=p>()</span>
</span></span></code></pre></div></li></ul><h3 id=èŠ‚ç‚¹äº¤äº’>èŠ‚ç‚¹äº¤äº’<a hidden class=anchor aria-hidden=true href=#èŠ‚ç‚¹äº¤äº’>#</a></h3><ul><li>Seleniumå¯ä»¥é©±åŠ¨æµè§ˆå™¨æ¥æ‰§è¡Œä¸€äº›æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥è®©æµè§ˆå™¨æ¨¡æ‹Ÿæ‰§è¡Œä¸€äº›åŠ¨ä½œã€‚æ¯”è¾ƒå¸¸è§çš„ç”¨æ³•æœ‰ï¼šè¾“å…¥æ–‡å­—æ—¶ç”¨<code>send_keys()</code>æ–¹æ³•ï¼Œæ¸…ç©ºæ–‡å­—æ—¶ç”¨<code>clear()</code>æ–¹æ³•ï¼Œç‚¹å‡»æŒ‰é’®æ—¶ç”¨<code>click()</code>æ–¹æ³•ã€‚</li></ul><h3 id=æ‰§è¡Œjs>æ‰§è¡Œjs<a hidden class=anchor aria-hidden=true href=#æ‰§è¡Œjs>#</a></h3><p>å¯¹äºæŸäº›æ“ä½œï¼ŒSelenium APIå¹¶æ²¡æœ‰æä¾›ã€‚æ¯”å¦‚ï¼Œä¸‹æ‹‰è¿›åº¦æ¡ï¼Œå®ƒå¯ä»¥ç›´æ¥æ¨¡æ‹Ÿè¿è¡ŒJavaScriptï¼Œæ­¤æ—¶ä½¿ç”¨<code>execute_script()</code>æ–¹æ³•å³å¯å®ç°ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>time</span> <span class=kn>import</span> <span class=n>sleep</span>
</span></span><span class=line><span class=cl><span class=c1>#1.åˆ›å»ºä¸€ä¸ªæµè§ˆå™¨å¯¹è±¡,executable_pathæŒ‡å®šå½“å‰æµè§ˆå™¨çš„é©±åŠ¨ç¨‹åº</span>
</span></span><span class=line><span class=cl><span class=c1>#æ³¨æ„ï¼šæˆ‘å½“å‰æ˜¯macç³»ç»Ÿï¼Œé©±åŠ¨ç¨‹åºä¹Ÿæ˜¯macç‰ˆæœ¬çš„ï¼Œå¦‚æœæ˜¯windowç³»ç»Ÿæ³¨æ„æ›´æ¢é©±åŠ¨</span>
</span></span><span class=line><span class=cl><span class=n>bro</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=n>executable_path</span><span class=o>=</span><span class=s1>&#39;./chromedriver&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#2.æµè§ˆå™¨çš„è¯·æ±‚å‘é€</span>
</span></span><span class=line><span class=cl><span class=n>bro</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.jd.com/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#3.æ ‡ç­¾å®šä½:è°ƒç”¨findç³»åˆ—çš„å‡½æ•°è¿›è¡Œæ ‡ç­¾å®šä½</span>
</span></span><span class=line><span class=cl><span class=n>search_box</span> <span class=o>=</span> <span class=n>bro</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;key&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#4.èŠ‚ç‚¹äº¤äº’</span>
</span></span><span class=line><span class=cl><span class=n>search_box</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=s1>&#39;mac pro m1&#39;</span><span class=p>)</span><span class=c1>#å‘æŒ‡å®šæ ‡ç­¾ä¸­å½•å…¥å†…å®¹</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>btn</span> <span class=o>=</span> <span class=n>bro</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;search&#34;]/div/div[2]/button&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>btn</span><span class=o>.</span><span class=n>click</span><span class=p>()</span> <span class=c1>#ç‚¹å‡»æŒ‰é’®</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#jsæ³¨å…¥</span>
</span></span><span class=line><span class=cl><span class=n>bro</span><span class=o>.</span><span class=n>execute_script</span><span class=p>(</span><span class=s1>&#39;document.documentElement.scrollTo(0,2000)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#å…³é—­æµè§ˆå™¨</span>
</span></span><span class=line><span class=cl><span class=n>bro</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span></code></pre></div><ul><li><p>æ€è€ƒï¼šåœ¨çˆ¬è™«ä¸­ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨seleniumï¼Ÿseleniumå’Œçˆ¬è™«ä¹‹é—´çš„å…³è”æ˜¯ä»€ä¹ˆï¼Ÿ</p><ul><li><p>ä¾¿æ·çš„çˆ¬å–åŠ¨æ€åŠ è½½æ•°æ®ï¼ˆå¯è§å³å¯å¾—ï¼‰</p><ul><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=c1>#è·å–å‰5é¡µçš„ä¼ä¸šåç§°</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>lxml</span> <span class=kn>import</span> <span class=n>etree</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>bro</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=n>executable_path</span><span class=o>=</span><span class=s1>&#39;./chromedriver&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://scxk.nmpa.gov.cn:81/xk/&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>bro</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>#è·å–é¡µé¢æºç æ•°æ®(page_source)</span>
</span></span><span class=line><span class=cl>  <span class=n>page_text</span> <span class=o>=</span> <span class=n>bro</span><span class=o>.</span><span class=n>page_source</span>
</span></span><span class=line><span class=cl>  <span class=c1>#å°†å‰5é¡µçš„é¡µé¢æºç æ•°æ®å­˜å‚¨åˆ°è¯¥åˆ—è¡¨ä¸­</span>
</span></span><span class=line><span class=cl>  <span class=n>all_page_text_list</span> <span class=o>=</span> <span class=p>[</span><span class=n>page_text</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=c1>#ç‚¹å‡»ä¸‹ä¸€é¡µ</span>
</span></span><span class=line><span class=cl>      <span class=n>next_page_btn</span> <span class=o>=</span> <span class=n>bro</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;pageIto_next&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>next_page_btn</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>all_page_text_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>bro</span><span class=o>.</span><span class=n>page_source</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>page_text</span> <span class=ow>in</span> <span class=n>all_page_text_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=c1>#è§£ææ•°æ®</span>
</span></span><span class=line><span class=cl>      <span class=n>tree</span> <span class=o>=</span> <span class=n>etree</span><span class=o>.</span><span class=n>HTML</span><span class=p>(</span><span class=n>page_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>li_list</span> <span class=o>=</span> <span class=n>tree</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;gzlist&#34;]/li&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=n>li</span> <span class=ow>in</span> <span class=n>li_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>          <span class=n>title</span> <span class=o>=</span> <span class=n>li</span><span class=o>.</span><span class=n>xpath</span><span class=p>(</span><span class=s1>&#39;./dl/@title&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>          <span class=nb>print</span><span class=p>(</span><span class=n>title</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>bro</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span></code></pre></div></li></ul></li><li><p>ä¾¿æ·å®ç°æ¨¡æ‹Ÿç™»å½•</p><ul><li>åé¢åœ¨è¯´</li></ul></li></ul></li></ul><h3 id=è·å–é¡µé¢æºç æ•°æ®>è·å–é¡µé¢æºç æ•°æ®<a hidden class=anchor aria-hidden=true href=#è·å–é¡µé¢æºç æ•°æ®>#</a></h3><p>é€šè¿‡<code>page_source</code>å±æ€§å¯ä»¥è·å–ç½‘é¡µçš„æºä»£ç ï¼Œæ¥ç€å°±å¯ä»¥ä½¿ç”¨è§£æåº“ï¼ˆå¦‚æ­£åˆ™è¡¨è¾¾å¼ã€Beautiful Soupã€pyqueryç­‰ï¼‰æ¥æå–ä¿¡æ¯äº†ã€‚</p><h3 id=å‰è¿›å’Œåé€€>å‰è¿›å’Œåé€€<a hidden class=anchor aria-hidden=true href=#å‰è¿›å’Œåé€€>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#æ¨¡æ‹Ÿæµè§ˆå™¨çš„å‰è¿›åé€€</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;./chromedriver&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.baidu.com&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.taobao.com&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>back</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>forward</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=è·å–åŠ¨æ€åŠ è½½æ•°æ®>è·å–åŠ¨æ€åŠ è½½æ•°æ®<a hidden class=anchor aria-hidden=true href=#è·å–åŠ¨æ€åŠ è½½æ•°æ®>#</a></h3><ul><li>å®ç°å¯è§å³å¯å¾—</li></ul><h3 id=åŠ¨ä½œé“¾>åŠ¨ä½œé“¾<a hidden class=anchor aria-hidden=true href=#åŠ¨ä½œé“¾>#</a></h3><p>åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œä¸€äº›äº¤äº’åŠ¨ä½œéƒ½æ˜¯é’ˆå¯¹æŸä¸ªèŠ‚ç‚¹æ‰§è¡Œçš„ã€‚æ¯”å¦‚ï¼Œå¯¹äºè¾“å…¥æ¡†ï¼Œæˆ‘ä»¬å°±è°ƒç”¨å®ƒçš„è¾“å…¥æ–‡å­—å’Œæ¸…ç©ºæ–‡å­—æ–¹æ³•ï¼›å¯¹äºæŒ‰é’®ï¼Œå°±è°ƒç”¨å®ƒçš„ç‚¹å‡»æ–¹æ³•ã€‚å…¶å®ï¼Œè¿˜æœ‰å¦å¤–ä¸€äº›æ“ä½œï¼Œå®ƒä»¬æ²¡æœ‰ç‰¹å®šçš„æ‰§è¡Œå¯¹è±¡ï¼Œæ¯”å¦‚é¼ æ ‡æ‹–æ›³ã€é”®ç›˜æŒ‰é”®ç­‰ï¼Œè¿™äº›åŠ¨ä½œç”¨å¦ä¸€ç§æ–¹å¼æ¥æ‰§è¡Œï¼Œé‚£å°±æ˜¯åŠ¨ä½œé“¾ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium.webdriver</span> <span class=kn>import</span> <span class=n>ActionChains</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>time</span> <span class=kn>import</span> <span class=n>sleep</span>
</span></span><span class=line><span class=cl><span class=n>bro</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=n>executable_path</span><span class=o>=</span><span class=s1>&#39;./chromedriver&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>bro</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.runoob.com/try/try.php?filename=jqueryui-api-droppable&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#æ³¨æ„ï¼šå¦‚æœå®šä½çš„æ ‡ç­¾æ˜¯å­˜åœ¨äºiframeè¡¨ç¤ºçš„å­é¡µé¢ä¸­ï¼Œåˆ™å¸¸è§„çš„æ ‡ç­¾å®šä½æŠ¥é”™</span>
</span></span><span class=line><span class=cl><span class=c1>#å¤„ç†ï¼šä½¿ç”¨å¦‚ä¸‹æŒ‡å®šæ“ä½œ</span>
</span></span><span class=line><span class=cl><span class=n>bro</span><span class=o>.</span><span class=n>switch_to</span><span class=o>.</span><span class=n>frame</span><span class=p>(</span><span class=s1>&#39;iframeResult&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>div_tag</span> <span class=o>=</span> <span class=n>bro</span><span class=o>.</span><span class=n>find_element_by_id</span><span class=p>(</span><span class=s1>&#39;draggable&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#å®ä¾‹åŒ–ä¸€ä¸ªåŠ¨ä½œé“¾å¯¹è±¡ä¸”å°†è¯¥å¯¹è±¡ç»‘å®šåˆ°æŒ‡å®šçš„æµè§ˆå™¨ä¸­</span>
</span></span><span class=line><span class=cl><span class=n>action</span> <span class=o>=</span> <span class=n>ActionChains</span><span class=p>(</span><span class=n>bro</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>action</span><span class=o>.</span><span class=n>click_and_hold</span><span class=p>(</span><span class=n>div_tag</span><span class=p>)</span> <span class=c1>#å¯¹æŒ‡å®šæ ‡ç­¾å®ç°ç‚¹å‡»ä¸”é•¿æŒ‰æ“ä½œ</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>action</span><span class=o>.</span><span class=n>move_by_offset</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=mi>10</span><span class=p>)</span><span class=o>.</span><span class=n>perform</span><span class=p>()</span> <span class=c1>#performè®©åŠ¨ä½œé“¾ç«‹å³æ‰§è¡Œ</span>
</span></span><span class=line><span class=cl>    <span class=n>sleep</span><span class=p>(</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>bro</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=å¸¦éªŒè¯ç çš„æ¨¡æ‹Ÿç™»å½•>å¸¦éªŒè¯ç çš„æ¨¡æ‹Ÿç™»å½•<a hidden class=anchor aria-hidden=true href=#å¸¦éªŒè¯ç çš„æ¨¡æ‹Ÿç™»å½•>#</a></h3><ul><li><p>ç™»å½•bilibili</p><ul><li><a href="https://passport.bilibili.com/login?from_spm_id=333.851.top_bar.login_window">https://passport.bilibili.com/login?from_spm_id=333.851.top_bar.login_window</a></li></ul></li><li><p>è¯†åˆ«éªŒè¯ç æ¨¡å—å°è£…ï¼š</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>  <span class=c1># ä¸€ã€å›¾ç‰‡æ–‡å­—ç±»å‹(é»˜è®¤ 3 æ•°è‹±æ··åˆ)ï¼š</span>
</span></span><span class=line><span class=cl>  <span class=c1># 1 : çº¯æ•°å­—</span>
</span></span><span class=line><span class=cl>  <span class=c1># 1001ï¼šçº¯æ•°å­—2</span>
</span></span><span class=line><span class=cl>  <span class=c1># 2 : çº¯è‹±æ–‡</span>
</span></span><span class=line><span class=cl>  <span class=c1># 1002ï¼šçº¯è‹±æ–‡2</span>
</span></span><span class=line><span class=cl>  <span class=c1># 3 : æ•°è‹±æ··åˆ</span>
</span></span><span class=line><span class=cl>  <span class=c1># 1003ï¼šæ•°è‹±æ··åˆ2</span>
</span></span><span class=line><span class=cl>  <span class=c1>#  4 : é—ªåŠ¨GIF</span>
</span></span><span class=line><span class=cl>  <span class=c1># 7 : æ— æ„Ÿå­¦ä¹ (ç‹¬å®¶)</span>
</span></span><span class=line><span class=cl>  <span class=c1># 11 : è®¡ç®—é¢˜</span>
</span></span><span class=line><span class=cl>  <span class=c1># 1005:  å¿«é€Ÿè®¡ç®—é¢˜</span>
</span></span><span class=line><span class=cl>  <span class=c1># 16 : æ±‰å­—</span>
</span></span><span class=line><span class=cl>  <span class=c1># 32 : é€šç”¨æ–‡å­—è¯†åˆ«(è¯ä»¶ã€å•æ®)</span>
</span></span><span class=line><span class=cl>  <span class=c1># 66:  é—®ç­”é¢˜</span>
</span></span><span class=line><span class=cl>  <span class=c1># 49 :recaptchaå›¾ç‰‡è¯†åˆ«</span>
</span></span><span class=line><span class=cl>  <span class=c1># äºŒã€å›¾ç‰‡æ—‹è½¬è§’åº¦ç±»å‹ï¼š</span>
</span></span><span class=line><span class=cl>  <span class=c1># 29 :  æ—‹è½¬ç±»å‹</span>
</span></span><span class=line><span class=cl>  <span class=c1>#</span>
</span></span><span class=line><span class=cl>  <span class=c1># ä¸‰ã€å›¾ç‰‡åæ ‡ç‚¹é€‰ç±»å‹ï¼š</span>
</span></span><span class=line><span class=cl>  <span class=c1># 19 :  1ä¸ªåæ ‡</span>
</span></span><span class=line><span class=cl>  <span class=c1># 20 :  3ä¸ªåæ ‡</span>
</span></span><span class=line><span class=cl>  <span class=c1># 21 :  3 ~ 5ä¸ªåæ ‡</span>
</span></span><span class=line><span class=cl>  <span class=c1># 22 :  5 ~ 8ä¸ªåæ ‡</span>
</span></span><span class=line><span class=cl>  <span class=c1># 27 :  1 ~ 4ä¸ªåæ ‡</span>
</span></span><span class=line><span class=cl>  <span class=c1># 48 : è½¨è¿¹ç±»å‹</span>
</span></span><span class=line><span class=cl>  <span class=c1>#</span>
</span></span><span class=line><span class=cl>  <span class=c1># å››ã€ç¼ºå£è¯†åˆ«</span>
</span></span><span class=line><span class=cl>  <span class=c1># 18 : ç¼ºå£è¯†åˆ«ï¼ˆéœ€è¦2å¼ å›¾ ä¸€å¼ ç›®æ ‡å›¾ä¸€å¼ ç¼ºå£å›¾ï¼‰</span>
</span></span><span class=line><span class=cl>  <span class=c1># 33 : å•ç¼ºå£è¯†åˆ«ï¼ˆè¿”å›Xè½´åæ ‡ åªéœ€è¦1å¼ å›¾ï¼‰</span>
</span></span><span class=line><span class=cl>  <span class=c1># äº”ã€æ‹¼å›¾è¯†åˆ«</span>
</span></span><span class=line><span class=cl>  <span class=c1># 53ï¼šæ‹¼å›¾è¯†åˆ«</span>
</span></span><span class=line><span class=cl>  <span class=c1>#å‡½æ•°å®ç°å¿½ç•¥</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>base64_api</span><span class=p>(</span><span class=n>uname</span><span class=p>,</span> <span class=n>pwd</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=n>typeid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>          <span class=n>base64_data</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span></span><span class=line><span class=cl>          <span class=n>b64</span> <span class=o>=</span> <span class=n>base64_data</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;username&#34;</span><span class=p>:</span> <span class=n>uname</span><span class=p>,</span> <span class=s2>&#34;password&#34;</span><span class=p>:</span> <span class=n>pwd</span><span class=p>,</span> <span class=s2>&#34;typeid&#34;</span><span class=p>:</span> <span class=n>typeid</span><span class=p>,</span> <span class=s2>&#34;image&#34;</span><span class=p>:</span> <span class=n>b64</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=n>result</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&#34;http://api.ttshitu.com/predict&#34;</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>data</span><span class=p>)</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;success&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=n>result</span><span class=p>[</span><span class=s2>&#34;data&#34;</span><span class=p>][</span><span class=s2>&#34;result&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=n>result</span><span class=p>[</span><span class=s2>&#34;message&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>getImgCodeText</span><span class=p>(</span><span class=n>imgPath</span><span class=p>,</span><span class=n>imgType</span><span class=p>):</span><span class=c1>#ç›´æ¥è¿”å›éªŒè¯ç å†…å®¹</span>
</span></span><span class=line><span class=cl>      <span class=c1>#imgPathï¼šéªŒè¯ç å›¾ç‰‡åœ°å€</span>
</span></span><span class=line><span class=cl>      <span class=c1>#imgTypeï¼šéªŒè¯ç å›¾ç‰‡ç±»å‹</span>
</span></span><span class=line><span class=cl>      <span class=n>result</span> <span class=o>=</span> <span class=n>base64_api</span><span class=p>(</span><span class=n>uname</span><span class=o>=</span><span class=s1>&#39;å›¾é‰´çš„è´¦å·&#39;</span><span class=p>,</span> <span class=n>pwd</span><span class=o>=</span><span class=s1>&#39;å›¾é‰´çš„å¯†ç &#39;</span><span class=p>,</span> <span class=n>img</span><span class=o>=</span><span class=n>imgPath</span><span class=p>,</span> <span class=n>typeid</span><span class=o>=</span><span class=n>imgType</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>result</span>
</span></span></code></pre></div></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium.webdriver</span> <span class=kn>import</span> <span class=n>ActionChains</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>time</span> <span class=kn>import</span> <span class=n>sleep</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>tujian</span>
</span></span><span class=line><span class=cl>  <span class=c1>#1.åˆ›å»ºæµè§ˆå™¨å¯¹è±¡</span>
</span></span><span class=line><span class=cl>  <span class=n>bro</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=n>executable_path</span><span class=o>=</span><span class=s1>&#39;./chromedriver&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>#2.å‘èµ·è¯·æ±‚</span>
</span></span><span class=line><span class=cl>  <span class=n>login_url</span> <span class=o>=</span> <span class=s1>&#39;https://passport.bilibili.com/login?from_spm_id=333.851.top_bar.login_window&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>bro</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>login_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>#3.å®šä½åˆ°æŒ‡å®šæ ‡ç­¾å¡«å……ç”¨æˆ·åå’Œå¯†ç </span>
</span></span><span class=line><span class=cl>  <span class=n>user_box</span> <span class=o>=</span> <span class=n>bro</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;login-username&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>user_box</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=s1>&#39;15027900535&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>pwd_box</span> <span class=o>=</span> <span class=n>bro</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;login-passwd&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>pwd_box</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=s1>&#39;1234567890&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>login_btn</span> <span class=o>=</span> <span class=n>bro</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;geetest-wrap&#34;]/div/div[5]/a[1]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>login_btn</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>#4.å®šä½å®Œæ•´çš„éªŒè¯ç å¯¹è¯æ¡†</span>
</span></span><span class=line><span class=cl>  <span class=c1>#æ³¨æ„ï¼šåœ¨å¼€å‘è€…å·¥å…·ä¸­æ˜¯å¯ä»¥å®šä½åˆ°å¤šä¸ªdivè¡¨ç¤ºéªŒè¯ç å¯¹è¯æ¡†çš„ï¼Œå› æ­¤å°†è¿™å‡ ä¸ªdivéƒ½å®šä½åˆ°ï¼Œä»¥æ­¤å»å°è¯•</span>
</span></span><span class=line><span class=cl>  <span class=n>code_tag</span> <span class=o>=</span> <span class=n>bro</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;/html/body/div[2]/div[2]/div[6]/div/div&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>#5.è¯†åˆ«éªŒè¯ç ï¼ˆä½¿ç”¨æ‰“ç å¹³å°è¿›è¡ŒéªŒè¯ç è¯†åˆ«ï¼‰</span>
</span></span><span class=line><span class=cl>  <span class=n>code_tag</span><span class=o>.</span><span class=n>screenshot</span><span class=p>(</span><span class=s1>&#39;./code.png&#39;</span><span class=p>)</span><span class=c1>#å°†éªŒè¯ç å¯¹è¯æ¡†æˆªå›¾ä¿å­˜</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>#ä½¿ç”¨å›¾é‰´æ¥å£è¯†åˆ«</span>
</span></span><span class=line><span class=cl>  <span class=n>result</span> <span class=o>=</span> <span class=n>tujian</span><span class=o>.</span><span class=n>getImgCodeText</span><span class=p>(</span><span class=s1>&#39;./code.png&#39;</span><span class=p>,</span><span class=mi>27</span><span class=p>)</span><span class=c1>#è·å–äº†è¯†åˆ«çš„ç»“æœ</span>
</span></span><span class=line><span class=cl>  <span class=c1># result = &#39;154,251|145,167&#39;</span>
</span></span><span class=line><span class=cl>  <span class=c1># print(result)</span>
</span></span><span class=line><span class=cl>  <span class=n>result_list</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;|&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>#result_list == [&#39;154,251&#39;,&#39;145,167&#39;]</span>
</span></span><span class=line><span class=cl>  <span class=c1>#6.æ ¹æ®è¯†åˆ«å‡ºéªŒè¯ç çš„ç»“æœè¿›è¡Œå¤„ç†</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>pos</span> <span class=ow>in</span> <span class=n>result_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>x</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>pos</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>      <span class=n>y</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>pos</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>      <span class=n>ActionChains</span><span class=p>(</span><span class=n>bro</span><span class=p>)</span><span class=o>.</span><span class=n>move_to_element_with_offset</span><span class=p>(</span><span class=n>code_tag</span><span class=p>,</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span><span class=o>.</span><span class=n>perform</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=n>sleep</span><span class=p>(</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>confirm_btn</span> <span class=o>=</span> <span class=n>bro</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;/html/body/div[2]/div[2]/div[6]/div/div/div[3]/a/div&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>confirm_btn</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>bro</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span><span class=mi>1</span>
</span></span></code></pre></div></li></ul><h3 id=cookie>Cookie<a hidden class=anchor aria-hidden=true href=#cookie>#</a></h3><p>ä½¿ç”¨Seleniumï¼Œè¿˜å¯ä»¥æ–¹ä¾¿åœ°å¯¹Cookiesè¿›è¡Œæ“ä½œï¼Œä¾‹å¦‚å¸¸è§çš„è·å–Cookiesï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><ul><li>get_cookies()è¿”å›å€¼æ˜¯ç”±å­—å…¸ç»„æˆçš„åˆ—è¡¨ï¼Œå«åšjsonCookiesã€‚</li><li>éœ€è¦å°†jsonCookiesè§£ææˆæµè§ˆå™¨æºå¸¦çš„cookieå½¢å¼</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#è·å–jsonCookies</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;./chromedriver&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.zhihu.com/explore&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>browser</span><span class=o>.</span><span class=n>get_cookies</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div><ul><li><p>è§£æjsonCookiesæˆæµè§ˆå™¨çš„cookieå½¢å¼</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;./chromedriver&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>browser</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.zhihu.com/explore&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>#è·å–cookie</span>
</span></span><span class=line><span class=cl>  <span class=n>cookies</span> <span class=o>=</span> <span class=n>browser</span><span class=o>.</span><span class=n>get_cookies</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=c1>#è§£æcookie</span>
</span></span><span class=line><span class=cl>  <span class=n>dic</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>cookie</span> <span class=ow>in</span> <span class=n>cookies</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>key</span> <span class=o>=</span> <span class=n>cookie</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=n>value</span> <span class=o>=</span> <span class=n>cookie</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=n>dic</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=n>dic</span><span class=p>)</span> <span class=c1>#åœ¨çˆ¬è™«ä¸­å¯ä»¥ä½¿ç”¨çš„cookie</span>
</span></span><span class=line><span class=cl>  <span class=n>browser</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div></li><li><p>åŸºäºseleniumè·å–cookieåï¼Œç»•è¿‡æ¨¡æ‹Ÿç™»å½•</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium.webdriver</span> <span class=kn>import</span> <span class=n>Chrome</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>web</span> <span class=o>=</span> <span class=n>Chrome</span><span class=p>(</span><span class=s1>&#39;./chromedriver&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.17k.com/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1># ç™»å½•</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;header_login_user&#34;]/a[1]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># åˆ‡æ¢iframe</span>
</span></span><span class=line><span class=cl>  <span class=n>iframe</span> <span class=o>=</span> <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;/html/body/div[20]/div/div[1]/iframe&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>switch_to</span><span class=o>.</span><span class=n>frame</span><span class=p>(</span><span class=n>iframe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;/html/body/form/dl/dd[2]/input&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=s2>&#34;15027900535&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;/html/body/form/dl/dd[3]/input&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=s2>&#34;bobo328410948&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;/html/body/form/dl/dd[5]/input&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>cookies</span> <span class=o>=</span> <span class=n>web</span><span class=o>.</span><span class=n>get_cookies</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># å­˜æ–‡ä»¶é‡Œ</span>
</span></span><span class=line><span class=cl>  <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;cookies.txt&#34;</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s2>&#34;w&#34;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>cookies</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># ç»„è£…cookieå­—å…¸, ç›´æ¥ç»™requestsç”¨</span>
</span></span><span class=line><span class=cl>  <span class=n>dic</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>cook</span> <span class=ow>in</span> <span class=n>cookies</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>dic</span><span class=p>[</span><span class=n>cook</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]]</span> <span class=o>=</span> <span class=n>cook</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=c1># è¡”æ¥. æŠŠcookieç›´æ¥æ€¼è¿›å»</span>
</span></span><span class=line><span class=cl>  <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>  <span class=c1>#è®¿é—®çš„ä¹¦æ¶ï¼ˆè·å–ä¹¦æ¶å†…å®¹ï¼‰</span>
</span></span><span class=line><span class=cl>  <span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;https://user.17k.com/ck/author/shelf?page=1&amp;appKey=2406394919&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;cookie&#39;</span><span class=p>:</span><span class=n>dic</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>resp</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>cookies</span><span class=o>=</span><span class=n>dic</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=n>resp</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div></li></ul><h3 id=æ— å¤´æµè§ˆå™¨>æ— å¤´æµè§ˆå™¨<a hidden class=anchor aria-hidden=true href=#æ— å¤´æµè§ˆå™¨>#</a></h3><p>æ— å¤´æµè§ˆå™¨å°±æ˜¯æ²¡æœ‰å¯è§†åŒ–ç•Œé¢çš„æµè§ˆå™¨</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium.webdriver.chrome.options</span> <span class=kn>import</span> <span class=n>Options</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»ºä¸€ä¸ªå‚æ•°å¯¹è±¡ï¼Œç”¨æ¥æ§åˆ¶chromeä»¥æ— ç•Œé¢æ¨¡å¼æ‰“å¼€</span>
</span></span><span class=line><span class=cl><span class=n>chrome_options</span> <span class=o>=</span> <span class=n>Options</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>chrome_options</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;--headless&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>chrome_options</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;--disable-gpu&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># é©±åŠ¨è·¯å¾„</span>
</span></span><span class=line><span class=cl><span class=n>path</span> <span class=o>=</span> <span class=s1>&#39;./chromedriver&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»ºæµè§ˆå™¨å¯¹è±¡</span>
</span></span><span class=line><span class=cl><span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=n>executable_path</span><span class=o>=</span><span class=n>path</span><span class=p>,</span><span class=n>options</span><span class=o>=</span><span class=n>chrome_options</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¸Šç½‘</span>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://www.baidu.com/&#39;</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>save_screenshot</span><span class=p>(</span><span class=s1>&#39;baidu.png&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=è§„é¿æ£€æµ‹é‡è¦>è§„é¿æ£€æµ‹ï¼ˆé‡è¦ï¼‰<a hidden class=anchor aria-hidden=true href=#è§„é¿æ£€æµ‹é‡è¦>#</a></h3><ul><li><p>ç°åœ¨ä¸å°‘å¤§ç½‘ç«™æœ‰å¯¹seleniumé‡‡å–äº†ç›‘æµ‹æœºåˆ¶ã€‚æ¯”å¦‚æ­£å¸¸æƒ…å†µä¸‹æˆ‘ä»¬ç”¨æµè§ˆå™¨è®¿é—®æ·˜å®ç­‰ç½‘ç«™çš„ window.navigator.webdriverçš„å€¼ä¸º undefinedæˆ–è€…ä¸ºfalseã€‚è€Œä½¿ç”¨seleniumè®¿é—®åˆ™è¯¥å€¼ä¸ºtrueã€‚é‚£ä¹ˆå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><ul><li>å®ç°jsæ³¨å…¥ï¼Œç»•è¿‡æ£€æµ‹</li></ul></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium.webdriver</span> <span class=kn>import</span> <span class=n>ActionChains</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium.webdriver</span> <span class=kn>import</span> <span class=n>Chrome</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium.webdriver.chrome.options</span> <span class=kn>import</span> <span class=n>Options</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>chrome_options</span> <span class=o>=</span> <span class=n>Options</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>chrome_options</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&#34;--disable-blink-features=AutomationControlled&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>chrome_options</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>driver</span> <span class=o>=</span> <span class=n>Chrome</span><span class=p>(</span><span class=s1>&#39;./chromedriver&#39;</span><span class=p>,</span><span class=n>options</span><span class=o>=</span><span class=n>chrome_options</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>#Seleniumåœ¨æ‰“å¼€ä»»ä½•é¡µé¢ä¹‹å‰ï¼Œå…ˆè¿è¡Œè¿™ä¸ªJsæ–‡ä»¶ã€‚</span>
</span></span><span class=line><span class=cl>  <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./stealth.min.js&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>js</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=c1>#è¿›è¡Œjsæ³¨å…¥ï¼Œç»•è¿‡æ£€æµ‹</span>
</span></span><span class=line><span class=cl>  <span class=c1>#execute_cdp_cmdæ‰§è¡Œcdpå‘½ä»¤ï¼ˆåœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­æ‰§è¡Œç›¸å…³æŒ‡ä»¤ï¼Œå®Œæˆç›¸å…³æ“ä½œï¼‰</span>
</span></span><span class=line><span class=cl>  <span class=c1>#Page.addScriptToEvaluateOnNewDocumentæ‰§è¡Œè„šæœ¬</span>
</span></span><span class=line><span class=cl>  <span class=n>driver</span><span class=o>.</span><span class=n>execute_cdp_cmd</span><span class=p>(</span><span class=s2>&#34;Page.addScriptToEvaluateOnNewDocument&#34;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;source&#34;</span><span class=p>:</span> <span class=n>js</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.taobao.com&#39;</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>12306å†æ¬¡æµ‹è¯•</p><ul><li><p>æ²¡æœ‰å®ç°è§„é¿æ£€æµ‹ä»£ç æ—¶çš„ç™»å½•ï¼š</p><ul><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium.webdriver</span> <span class=kn>import</span> <span class=n>Chrome</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium.webdriver</span> <span class=kn>import</span> <span class=n>ActionChains</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>time</span> <span class=kn>import</span> <span class=n>sleep</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>web</span> <span class=o>=</span> <span class=n>Chrome</span><span class=p>(</span><span class=n>executable_path</span><span class=o>=</span><span class=s1>&#39;./chromedriver&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;https://kyfw.12306.cn/otn/resources/login.html&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;toolbar_Div&#34;]/div[2]/div[2]/ul/li[1]/a&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;J-userName&#34;]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=s2>&#34;hehehe@126.com&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;J-password&#34;]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=s2>&#34;111111&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;J-login&#34;]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>action</span> <span class=o>=</span> <span class=n>ActionChains</span><span class=p>(</span><span class=n>web</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1># æ‰¾åˆ°æ»‘å—</span>
</span></span><span class=line><span class=cl>  <span class=n>btn</span> <span class=o>=</span> <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;nc_1_n1z&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>action</span><span class=o>.</span><span class=n>click_and_hold</span><span class=p>(</span><span class=n>btn</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=n>action</span><span class=o>.</span><span class=n>move_by_offset</span><span class=p>(</span><span class=mi>50</span><span class=p>,</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>perform</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=n>sleep</span><span class=p>(</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div></li></ul></li><li><p>å®ç°è§„é¿æ£€æµ‹åï¼š</p><ul><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium.webdriver</span> <span class=kn>import</span> <span class=n>Chrome</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium.webdriver</span> <span class=kn>import</span> <span class=n>ActionChains</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>time</span> <span class=kn>import</span> <span class=n>sleep</span>
</span></span><span class=line><span class=cl>  <span class=kn>from</span> <span class=nn>selenium.webdriver.chrome.options</span> <span class=kn>import</span> <span class=n>Options</span>
</span></span><span class=line><span class=cl>  <span class=n>chrome_options</span> <span class=o>=</span> <span class=n>Options</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>chrome_options</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&#34;--disable-blink-features=AutomationControlled&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>chrome_options</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>web</span> <span class=o>=</span> <span class=n>Chrome</span><span class=p>(</span><span class=n>executable_path</span><span class=o>=</span><span class=s1>&#39;./chromedriver&#39;</span><span class=p>,</span><span class=n>options</span><span class=o>=</span><span class=n>chrome_options</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>#Seleniumåœ¨æ‰“å¼€ä»»ä½•é¡µé¢ä¹‹å‰ï¼Œå…ˆè¿è¡Œè¿™ä¸ªJsæ–‡ä»¶ã€‚</span>
</span></span><span class=line><span class=cl>  <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./stealth.min.js&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>js</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=c1>#è¿›è¡Œjsæ³¨å…¥ï¼Œç»•è¿‡æ£€æµ‹</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>execute_cdp_cmd</span><span class=p>(</span><span class=s2>&#34;Page.addScriptToEvaluateOnNewDocument&#34;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;source&#34;</span><span class=p>:</span> <span class=n>js</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;https://kyfw.12306.cn/otn/resources/login.html&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;toolbar_Div&#34;]/div[2]/div[2]/ul/li[1]/a&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;J-userName&#34;]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=s2>&#34;hehehe@126.com&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;J-password&#34;]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=s2>&#34;111111&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;J-login&#34;]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>action</span> <span class=o>=</span> <span class=n>ActionChains</span><span class=p>(</span><span class=n>web</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1># æ‰¾åˆ°æ»‘å—</span>
</span></span><span class=line><span class=cl>  <span class=n>btn</span> <span class=o>=</span> <span class=n>web</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;nc_1_n1z&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>action</span><span class=o>.</span><span class=n>click_and_hold</span><span class=p>(</span><span class=n>btn</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=n>action</span><span class=o>.</span><span class=n>move_by_offset</span><span class=p>(</span><span class=mi>50</span><span class=p>,</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>perform</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=n>sleep</span><span class=p>(</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>web</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div></li></ul></li></ul></li></ul></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div id=QR style=opacity:0><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=https://canw0916.github.io/img/wxPay.jpg alt=wechat_pay></a><p>å¾®ä¿¡</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=https://canw0916.github.io/img/aliPay.jpg alt=alipay></a><p>æ”¯ä»˜å®</p></div></div><button id=rewardButton onclick='var qr=document.getElementById("QR");qr.style.opacity==="0"?qr.style.opacity="1":qr.style.opacity="0"'>
<span>ğŸ§§ é¼“åŠ±</span></button></div></div><footer class=post-footer><nav class=paginav><a class=prev href=https://canw0916.github.io/en/posts/tech/mysql%E6%95%B0%E6%8D%AE%E5%BA%93/><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>Mysqlæ•°æ®åº“</span></a>
<a class=next href=https://canw0916.github.io/en/posts/tech/m3u8%E6%B5%81%E8%A7%86%E9%A2%91%E6%95%B0%E6%8D%AE%E7%88%AC%E8%99%AB/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>M3U8æµè§†é¢‘æ•°æ®çˆ¬è™«</span></a></nav></footer></div><div><div class=pagination__title><span class=pagination__title-h style=font-size:20px>ğŸ’¬è¯„è®º</span><hr></div><div id=tcomment></div><script src=https://utteranc.es/client.js repo=canw0916/utterances_comments issue-term=title theme=photon-dark crossorigin=anonymous async></script></div></article></main><script async src=https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js></script>
<script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><footer class=footer><span>Copyright
&copy;
2023-2023
<a href=https://canw0916.github.io/en/ style=color:#939393>Felix's Blog</a>
All Rights Reserved</span>
<a href=https://beian.miit.gov.cn/ target=_blank style=color:#939393></a>&nbsp;
<span><a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=null" style=display:inline-block;text-decoration:none;height:20px;color:#939393><img src style="float:left;margin:0 5px 0 0"></a></span>
<span id=busuanzi_container><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css>æ€»è®¿å®¢æ•°: <span id=busuanzi_value_site_uv></span>
æ€»è®¿é—®é‡: <span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg><span id=read_progress></span></span></a>
<script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>let mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>400||document.documentElement.scrollTop>400?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="ğŸ“„å¤åˆ¶";function s(){t.innerText="ğŸ‘ŒğŸ»å·²å¤åˆ¶!",setTimeout(()=>{t.innerText="ğŸ“„å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){let t=e.textContent+`
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€ŒFelix's Blogã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚
åŸæ–‡é“¾æ¥ï¼š`+location.href;navigator.clipboard.writeText(t),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild===n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName==="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script src=https://code.jquery.com/jquery-1.12.4.min.js></script>
<script>$("code[class^=language] ").on("mouseover",function(){this.clientWidth<this.scrollWidth&&$(this).css("width","135%")}).on("mouseout",function(){$(this).css("width","100%")})</script></body></html>